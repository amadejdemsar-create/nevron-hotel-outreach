<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nevron Hotel Outreach Generator</title>
<style>
  :root {
    --bg: #080C13;
    --surface: #0e1319;
    --surface-2: #161c24;
    --surface-3: #1e252e;
    --border: #262e38;
    --border-light: #353941;
    --text: #E0E1E2;
    --text-dim: #B4B6B9;
    --text-muted: #707379;
    --accent: #1B92FF;
    --accent-light: #73C7FF;
    --accent-glow: rgba(27, 146, 255, 0.12);
    --green: #36A068;
    --green-dim: rgba(54, 160, 104, 0.12);
    --orange: #F6A900;
    --orange-dim: rgba(246, 169, 0, 0.10);
    --red: #DA2025;
    --red-dim: rgba(218, 32, 37, 0.10);
    --blue: #0A66C2;
    --blue-dim: rgba(10, 102, 194, 0.12);
    --navy: #000126;
    --navy-mid: #002391;
    --radius: 12px;
    --radius-sm: 8px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Neue Haas Unica', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.65;
    font-size: 15px;
    -webkit-font-smoothing: antialiased;
  }

  /* NAV */
  .nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: rgba(8, 12, 19, 0.9);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 0 40px;
    height: 56px;
    display: flex;
    align-items: center;
    gap: 24px;
  }
  .nav-logo {
    display: flex;
    align-items: center;
    gap: 12px;
    white-space: nowrap;
  }
  .nav-logo svg {
    height: 18px;
    width: auto;
  }
  .nav-logo-divider {
    width: 1px;
    height: 20px;
    background: var(--border-light);
  }
  .nav-logo-text {
    font-weight: 500;
    font-size: 13px;
    letter-spacing: 0.3px;
    color: var(--text-muted);
    text-transform: uppercase;
  }
  .nav-links {
    display: flex;
    gap: 4px;
    overflow-x: auto;
    scrollbar-width: none;
  }
  .nav-links::-webkit-scrollbar { display: none; }
  .nav-links a {
    color: var(--text-dim);
    text-decoration: none;
    font-size: 13px;
    font-weight: 500;
    padding: 6px 12px;
    border-radius: 6px;
    white-space: nowrap;
    transition: all 0.2s;
    cursor: pointer;
  }
  .nav-links a:hover {
    color: var(--text);
    background: var(--surface-2);
  }

  /* HERO */
  .hero {
    padding: 120px 40px 60px;
    max-width: 900px;
    margin: 0 auto;
  }
  .hero-badge {
    display: inline-block;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--accent-light);
    background: var(--accent-glow);
    border: 1px solid rgba(27, 146, 255, 0.25);
    padding: 5px 14px;
    border-radius: 20px;
    margin-bottom: 24px;
  }
  .hero h1 {
    font-size: 44px;
    font-weight: 800;
    letter-spacing: -1.5px;
    line-height: 1.15;
    margin-bottom: 16px;
    background: linear-gradient(135deg, #E0E1E2 20%, var(--accent-light) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .hero p {
    font-size: 17px;
    color: var(--text-dim);
    max-width: 680px;
    line-height: 1.7;
  }

  /* CONTAINERS */
  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 40px;
  }

  section { padding: 60px 0; }

  .section-label {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 12px;
  }
  .section-label.purple { color: var(--accent-light); }
  .section-label.green { color: var(--green); }
  .section-label.orange { color: var(--orange); }
  .section-label.blue { color: var(--blue); }
  .section-label.pink { color: var(--red); }
  .section-label.red { color: var(--red); }

  .section-title {
    font-size: 32px;
    font-weight: 700;
    letter-spacing: -0.8px;
    margin-bottom: 12px;
  }
  .section-desc {
    font-size: 16px;
    color: var(--text-dim);
    max-width: 700px;
    line-height: 1.7;
  }

  /* LANGUAGE TOGGLE */
  .lang-bar {
    display: flex;
    justify-content: center;
    margin-bottom: 36px;
  }
  .lang-toggle {
    display: inline-flex;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    overflow: hidden;
  }
  .lang-toggle input { display: none; }
  .lang-toggle label {
    padding: 10px 24px;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
  }
  .lang-toggle input:checked + label {
    background: var(--accent-glow);
    color: var(--accent-light);
  }
  .lang-toggle label:first-of-type {
    border-right: 1px solid var(--border);
  }

  /* FORM */
  .form-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 24px;
  }

  .form-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
    position: relative;
    overflow: hidden;
  }
  .form-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
  }
  .form-card.purple::before { background: linear-gradient(90deg, var(--accent), var(--accent-light)); }
  .form-card.green::before { background: linear-gradient(90deg, #2a8a58, var(--green)); }
  .form-card.orange::before { background: linear-gradient(90deg, #E56600, var(--orange)); }

  .form-card-title {
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 20px;
    letter-spacing: -0.2px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .form-card-icon {
    width: 28px;
    height: 28px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
  }
  .form-card.purple .form-card-title { color: var(--accent-light); }
  .form-card.purple .form-card-icon { background: var(--accent-glow); }
  .form-card.green .form-card-title { color: var(--green); }
  .form-card.green .form-card-icon { background: var(--green-dim); }
  .form-card.orange .form-card-title { color: var(--orange); }
  .form-card.orange .form-card-icon { background: var(--orange-dim); }

  .form-group { margin-bottom: 16px; }
  .form-group:last-child { margin-bottom: 0; }

  .form-label {
    display: block;
    font-size: 12px;
    font-weight: 600;
    color: var(--text-dim);
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .form-input,
  .form-select,
  .form-textarea {
    width: 100%;
    background: var(--surface-2);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 10px 14px;
    color: var(--text);
    font-size: 14px;
    font-family: inherit;
    transition: border-color 0.2s;
    outline: none;
  }
  .form-input:focus,
  .form-select:focus,
  .form-textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(27, 146, 255, 0.1);
  }
  .form-input:disabled,
  .form-select:disabled,
  .form-textarea:disabled {
    opacity: 0.35;
    cursor: not-allowed;
  }
  .form-textarea {
    resize: vertical;
    min-height: 80px;
  }
  .form-select {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238888a0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    padding-right: 32px;
  }

  .radio-group { display: flex; gap: 8px; }
  .radio-option { flex: 1; position: relative; }
  .radio-option input { position: absolute; opacity: 0; width: 0; height: 0; }
  .radio-option label {
    display: block;
    text-align: center;
    padding: 8px 12px;
    background: var(--surface-2);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    font-size: 13px;
    font-weight: 500;
    color: var(--text-dim);
    cursor: pointer;
    transition: all 0.2s;
  }
  .radio-option input:checked + label {
    background: var(--accent-glow);
    border-color: var(--accent);
    color: var(--accent-light);
  }

  .toggle-group { display: flex; gap: 8px; }
  .toggle-option { flex: 1; position: relative; }
  .toggle-option input { position: absolute; opacity: 0; width: 0; height: 0; }
  .toggle-option label {
    display: block;
    text-align: center;
    padding: 8px 12px;
    background: var(--surface-2);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    font-size: 13px;
    font-weight: 500;
    color: var(--text-dim);
    cursor: pointer;
    transition: all 0.2s;
  }
  .toggle-option input:checked + label {
    background: var(--accent-glow);
    border-color: var(--accent);
    color: var(--accent-light);
  }

  .conditional-field {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease, margin 0.3s ease, opacity 0.3s ease;
    opacity: 0;
    margin-top: 0;
  }
  .conditional-field.visible {
    max-height: 200px;
    opacity: 1;
    margin-top: 12px;
  }

  .form-hint {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 4px;
  }

  /* BUTTONS */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 28px;
    border-radius: var(--radius-sm);
    font-size: 14px;
    font-weight: 600;
    font-family: inherit;
    cursor: pointer;
    transition: all 0.2s;
    border: none;
  }
  .btn-primary {
    background: linear-gradient(135deg, var(--accent), #0070E0);
    color: white;
  }
  .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 24px rgba(27, 146, 255, 0.35);
  }
  .btn-secondary {
    background: var(--surface-2);
    color: var(--text);
    border: 1px solid var(--border);
  }
  .btn-secondary:hover {
    background: var(--surface-3);
    border-color: var(--border-light);
  }
  .btn-sm {
    padding: 6px 14px;
    font-size: 12px;
    border-radius: 6px;
  }
  .btn-copy {
    background: var(--surface-3);
    color: var(--text-dim);
    border: 1px solid var(--border);
    padding: 6px 14px;
    font-size: 12px;
    border-radius: 6px;
  }
  .btn-copy:hover {
    background: var(--accent-glow);
    border-color: var(--accent);
    color: var(--accent-light);
  }
  .btn-copy.copied {
    background: var(--green-dim);
    border-color: rgba(54, 160, 104, 0.3);
    color: var(--green);
  }
  .btn-row {
    display: flex;
    gap: 12px;
    align-items: center;
    margin-top: 32px;
  }

  /* SUMMARY */
  .summary-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-top: 24px;
  }
  .summary-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px 24px;
  }
  .summary-label {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-muted);
    margin-bottom: 8px;
  }
  .summary-value {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
    line-height: 1.5;
  }
  .summary-value small {
    font-size: 13px;
    font-weight: 400;
    color: var(--text-dim);
  }

  .channel-badges { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 4px; }
  .channel-badge {
    font-size: 11px;
    font-weight: 600;
    padding: 3px 10px;
    border-radius: 12px;
  }
  .channel-badge.email { color: var(--accent-light); background: var(--accent-glow); }
  .channel-badge.linkedin { color: var(--blue); background: var(--blue-dim); }
  .channel-badge.whatsapp { color: var(--green); background: var(--green-dim); }
  .channel-badge.phone { color: var(--orange); background: var(--orange-dim); }

  /* PHASE TIMELINE (redesigned) */
  .phase-timeline {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-top: 32px;
  }
  .phase-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
  }
  .phase-card-header {
    padding: 14px 20px;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .phase-card-header.reveal { background: linear-gradient(135deg, rgba(27, 146, 255, 0.12), rgba(162, 155, 254, 0.06)); }
  .phase-card-header.value { background: linear-gradient(135deg, rgba(54, 160, 104, 0.10), rgba(54, 160, 104, 0.04)); }
  .phase-card-header.conversion { background: linear-gradient(135deg, rgba(246, 169, 0, 0.10), rgba(246, 169, 0, 0.04)); }
  .phase-name {
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.2px;
  }
  .phase-card-header.reveal .phase-name { color: var(--accent-light); }
  .phase-card-header.value .phase-name { color: var(--green); }
  .phase-card-header.conversion .phase-name { color: var(--orange); }
  .phase-days {
    font-size: 11px;
    color: var(--text-muted);
    font-weight: 500;
  }
  .phase-items { padding: 6px 0; }
  .phase-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 20px;
    transition: background 0.15s;
  }
  .phase-item:hover { background: var(--surface-2); }
  .phase-item-day {
    font-weight: 700;
    color: var(--text-muted);
    min-width: 36px;
    font-size: 12px;
  }
  .phase-item-channel {
    font-size: 10px;
    font-weight: 600;
    padding: 3px 10px;
    border-radius: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    min-width: 76px;
    text-align: center;
  }
  .phase-item-channel.email { color: var(--accent-light); background: var(--accent-glow); }
  .phase-item-channel.linkedin { color: var(--blue); background: var(--blue-dim); }
  .phase-item-channel.whatsapp { color: var(--green); background: var(--green-dim); }
  .phase-item-channel.phone { color: var(--orange); background: var(--orange-dim); }
  .phase-item-purpose {
    color: var(--text-dim);
    font-size: 13px;
    flex: 1;
    min-width: 0;
  }

  /* MESSAGE CARDS */
  .message-cards {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin-top: 32px;
  }
  .message-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
    border-left: 3px solid var(--border);
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .message-card:hover {
    box-shadow: 0 2px 16px rgba(0,0,0,0.2);
  }
  .message-card.ch-email { border-left-color: var(--accent); }
  .message-card.ch-linkedin { border-left-color: var(--blue); }
  .message-card.ch-whatsapp { border-left-color: var(--green); }
  .message-card.ch-phone { border-left-color: var(--orange); }

  .message-card-header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 24px;
    border-bottom: 1px solid var(--border);
    background: var(--surface-2);
  }
  .message-channel-icon {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    flex-shrink: 0;
  }
  .message-channel-icon.email { background: var(--accent-glow); }
  .message-channel-icon.linkedin { background: var(--blue-dim); }
  .message-channel-icon.whatsapp { background: var(--green-dim); }
  .message-channel-icon.phone { background: var(--orange-dim); }
  .message-meta { flex: 1; min-width: 0; }
  .message-meta-top {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 2px;
  }
  .message-day { font-size: 12px; font-weight: 700; color: var(--text); }
  .message-phase-tag {
    font-size: 10px;
    font-weight: 600;
    padding: 2px 8px;
    border-radius: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  .message-phase-tag.reveal { color: var(--accent-light); background: var(--accent-glow); }
  .message-phase-tag.value { color: var(--green); background: var(--green-dim); }
  .message-phase-tag.conversion { color: var(--orange); background: var(--orange-dim); }
  .message-purpose { font-size: 13px; color: var(--text-dim); }

  .message-card-body { padding: 20px 24px; }
  .message-subject {
    font-size: 13px;
    font-weight: 600;
    color: var(--accent-light);
    margin-bottom: 12px;
    padding: 8px 14px;
    background: var(--accent-glow);
    border-radius: 6px;
    border: 1px solid rgba(27, 146, 255, 0.15);
    display: inline-block;
  }
  .message-text {
    font-size: 14px;
    color: var(--text-dim);
    line-height: 1.75;
    white-space: pre-wrap;
  }
  .message-note {
    margin-top: 14px;
    padding: 12px 14px;
    background: var(--surface-2);
    border-radius: 6px;
    border-left: 2px solid var(--text-muted);
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.6;
  }
  .message-card-footer {
    display: flex;
    justify-content: flex-end;
    padding: 10px 24px;
    border-top: 1px solid var(--border);
    gap: 8px;
  }

  /* KPI ROW */
  .kpi-row {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 16px;
    margin: 32px 0;
  }
  .kpi {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 24px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .kpi::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
  }
  .kpi.kpi-green::before { background: var(--green); }
  .kpi.kpi-accent::before { background: var(--accent); }
  .kpi.kpi-blue::before { background: var(--blue); }
  .kpi.kpi-orange::before { background: var(--orange); }
  .kpi-value {
    font-size: 28px;
    font-weight: 800;
    letter-spacing: -0.5px;
    margin-bottom: 4px;
  }
  .kpi-value.green { color: var(--green); }
  .kpi-value.accent { color: var(--accent-light); }
  .kpi-value.orange { color: var(--orange); }
  .kpi-value.blue { color: var(--blue); }
  .kpi-label { font-size: 12px; color: var(--text-dim); font-weight: 500; }

  /* CALLOUT */
  .callout {
    background: var(--accent-glow);
    border: 1px solid rgba(27, 146, 255, 0.2);
    border-radius: var(--radius);
    padding: 24px 28px;
    margin: 24px 0;
  }
  .callout.warn {
    background: var(--orange-dim);
    border-color: rgba(246, 169, 0, 0.2);
  }
  .callout.info {
    background: var(--blue-dim);
    border-color: rgba(10, 102, 194, 0.2);
  }
  .callout-title { font-size: 14px; font-weight: 700; margin-bottom: 6px; }
  .callout-text { font-size: 13px; color: var(--text-dim); line-height: 1.65; }

  /* LOOM */
  .loom-script {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
    margin-top: 20px;
  }
  .loom-step { display: flex; gap: 16px; margin-bottom: 16px; }
  .loom-step:last-child { margin-bottom: 0; }
  .loom-step-num {
    width: 28px; height: 28px;
    border-radius: 50%;
    background: var(--accent-glow);
    border: 1px solid rgba(27, 146, 255, 0.3);
    display: flex; align-items: center; justify-content: center;
    font-size: 12px; font-weight: 700; color: var(--accent-light);
    flex-shrink: 0;
  }
  .loom-step-content { flex: 1; }
  .loom-step-title { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
  .loom-step-desc { font-size: 13px; color: var(--text-dim); line-height: 1.6; }

  /* CHECKLIST */
  .checklist-wrap {
    border: 1px solid var(--border);
    border-radius: var(--radius);
    overflow: hidden;
    margin-top: 20px;
  }
  .checklist-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
  }
  .checklist-table thead { background: var(--surface-2); }
  .checklist-table th {
    text-align: left;
    padding: 12px 20px;
    font-weight: 600;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    color: var(--text-dim);
    border-bottom: 1px solid var(--border);
  }
  .checklist-table td {
    padding: 12px 20px;
    border-bottom: 1px solid var(--border);
    color: var(--text-dim);
  }
  .checklist-table tr:last-child td { border-bottom: none; }
  .checklist-table tr:hover td { background: var(--surface); }
  .checklist-table td:first-child { width: 40px; text-align: center; }
  .checklist-cb { width: 16px; height: 16px; accent-color: var(--accent); cursor: pointer; }
  .checklist-table tr.checked td { opacity: 0.45; text-decoration: line-through; }

  /* FOOTER */
  .footer {
    padding: 40px;
    text-align: center;
    font-size: 13px;
    color: var(--text-muted);
    border-top: 1px solid var(--border);
    margin-top: 40px;
  }
  .section-divider {
    border-top: 1px solid var(--border);
    margin-top: 60px;
    padding-top: 60px;
  }

  /* TOAST */
  .toast {
    position: fixed;
    bottom: 24px;
    right: 24px;
    background: var(--green);
    color: #080C13;
    padding: 12px 20px;
    border-radius: var(--radius-sm);
    font-size: 13px;
    font-weight: 600;
    z-index: 200;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.3s ease;
    pointer-events: none;
  }
  .toast.show { opacity: 1; transform: translateY(0); }

  /* VALIDATION */
  .form-input.error, .form-select.error { border-color: var(--red); }
  .form-error { font-size: 11px; color: var(--red); margin-top: 4px; display: none; }
  .form-error.show { display: block; }

  /* RESPONSIVE */
  @media (max-width: 900px) {
    .form-grid, .phase-timeline { grid-template-columns: 1fr; }
    .summary-grid { grid-template-columns: 1fr; }
    .kpi-row { grid-template-columns: repeat(2, 1fr); }
    .hero h1 { font-size: 32px; }
    .hero { padding: 100px 20px 40px; }
    .container { padding: 0 20px; }
    .nav { padding: 0 20px; }
  }

  /* PRINT */
  @media print {
    :root {
      --bg: #ffffff; --surface: #f8f9fa; --surface-2: #f0f1f3;
      --surface-3: #e8e9eb; --border: #d0d2d6; --border-light: #B4B6B9;
      --text: #080C13; --text-dim: #353941; --text-muted: #707379;
      --accent: #002391; --accent-light: #002391; --accent-glow: rgba(0,35,145,0.06);
      --green: #2a8a58; --green-dim: rgba(42,138,88,0.06);
      --orange: #c49000; --orange-dim: rgba(196,144,0,0.06);
      --blue: #0A66C2; --blue-dim: rgba(10,102,194,0.06);
    }
    body { background: white; color: #080C13; font-size: 12px; }
    .nav, .btn-copy, .btn-row, .message-card-footer, #form-view, .no-print, .toast { display: none !important; }
    .hero { padding: 20px 0; }
    .hero h1 { font-size: 28px; -webkit-text-fill-color: #080C13; background: none; }
    .container { padding: 0; max-width: 100%; }
    section { padding: 20px 0; }
    .section-divider { margin-top: 20px; padding-top: 20px; }
    .message-card { break-inside: avoid; page-break-inside: avoid; margin-bottom: 12px; }
    .kpi-row { grid-template-columns: repeat(4, 1fr); }
    .summary-grid { grid-template-columns: repeat(3, 1fr); }
    .phase-timeline { grid-template-columns: repeat(3, 1fr); }
  }
</style>
</head>
<body>

<div style="position:fixed;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#000126,#002391,#1B92FF);z-index:101;"></div>

<nav class="nav" style="top:2px;">
  <div class="nav-logo">
    <svg viewBox="0 0 960 277" fill="none" xmlns="http://www.w3.org/2000/svg"><g fill="#fff"><path d="M244.3 93.9h30.5V2.1H183v30.5h61.3V93.9zM30.5 185.1H0v91.8h91.8v-30.5H30.5V185.1zM274.8 185.1h-30.5V233L30.5 2.1H0v91.8h30.5V45.7l213.7 231.1h30.5V185.1z"/><path d="M467.4 0c-15.3 0-25.3 7.5-29.8 16.7V2.1h-25.4v91.8h25.4v-53c0-13.5 8.2-20.2 19.1-20.2 11.2 0 16.1 6 16.1 18.4v54.7h25.4V35.4C498.3 10.9 485.5 0 467.4 0zM557.3 0c-26.7 0-47.2 18.8-47.2 47.7v1.4c0 29.3 20.2 46.7 47.9 46.7 25.1 0 40.9-11.1 43.9-30.9h-24c-1.6 7.7-7.4 12.8-19.1 12.8-13.9 0-22.1-8.8-22.8-24h66.2v-7C602.1 13.9 581 0 557.3 0zM536.3 38.1c1.9-13 9.7-20.5 21.1-20.5 12.1 0 19.1 6.7 20 20.5H536.3zM813.3 0c-27.5 0-48.4 18.8-48.4 47.6V49c0 28.6 20.9 46.8 48.3 46.8 27.5 0 48.4-18.4 48.4-47.4V47C861.5 18.4 840.8 0 813.3 0zM835.7 48.6c0 17.4-8.2 27.9-22.5 27.9-14.4 0-22.5-10.5-22.5-28.1V47c0-17.5 8.4-27.7 22.5-27.7 14.2 0 22.5 10.5 22.5 28.1V48.6zM929.1 0c-15.3 0-25.3 7.5-29.8 16.7V2.1h-25.4v91.8h25.4v-53c0-13.5 8.2-20.2 19.1-20.2 11.2 0 16.1 6 16.1 18.4v54.7H960V35.4C960 10.9 947.2 0 929.1 0zM730.6 19.7V2.1h-25.4v91.8h25.4v-46c0-17.5 10.9-23.7 29.7-23.5V0.7C745.4.9 736.4 7.4 730.6 19.7zM650.9 67.7 629 2.1h-27.2l33.5 91.8h28.6l33.3-91.8h-24.6L650.9 67.7z"/></g></svg>
    <div class="nav-logo-divider"></div>
    <span class="nav-logo-text">Outreach</span>
  </div>
  <div class="nav-links" id="nav-links">
    <a onclick="showForm()">Detailed Strategy</a>
    <a onclick="showGeneralForm()">General Outreach</a>
  </div>
</nav>

<div id="app">

  <!-- FORM VIEW -->
  <div id="form-view">
    <div class="hero">
      <div class="hero-badge">Outreach Generator</div>
      <h1>Hotel Outreach Strategy</h1>
      <p>Generate a personalized, multi-channel outreach sequence for any hotel project. Fill in the details below to produce copy-paste ready messages, ROI projections, and a tracking checklist.</p>
    </div>

    <div class="container">
      <form id="outreach-form" novalidate>

        <!-- LANGUAGE -->
        <div class="lang-bar">
          <div class="lang-toggle">
            <input type="radio" name="lang" id="lang-sl" value="sl" checked>
            <label for="lang-sl">Slovenščina</label>
            <input type="radio" name="lang" id="lang-en" value="en">
            <label for="lang-en">English</label>
          </div>
        </div>

        <div class="form-grid">

          <!-- HOTEL INFO -->
          <div class="form-card purple">
            <div class="form-card-title"><div class="form-card-icon">&#127976;</div> Hotel Info</div>

            <div class="form-group">
              <label class="form-label" for="hotelName">Hotel Name *</label>
              <input type="text" id="hotelName" class="form-input" required placeholder="Grand Hotel Toplice">
              <div class="form-error" id="err-hotelName">Hotel name is required</div>
            </div>
            <div class="form-group">
              <label class="form-label" for="city">City / Location *</label>
              <input type="text" id="city" class="form-input" required placeholder="Bled, Slovenia">
              <div class="form-error" id="err-city">City is required</div>
            </div>
            <div class="form-group">
              <label class="form-label" for="roomCount">Room Count *</label>
              <input type="number" id="roomCount" class="form-input" required min="1" placeholder="87">
              <div class="form-error" id="err-roomCount">Room count is required</div>
            </div>
            <div class="form-group">
              <label class="form-label">Star Rating *</label>
              <div class="radio-group">
                <div class="radio-option"><input type="radio" name="starRating" id="star3" value="3"><label for="star3">3 Star</label></div>
                <div class="radio-option"><input type="radio" name="starRating" id="star4" value="4" checked><label for="star4">4 Star</label></div>
                <div class="radio-option"><input type="radio" name="starRating" id="star5" value="5"><label for="star5">5 Star</label></div>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label" for="portalUrl">Portal / PWA URL *</label>
              <input type="url" id="portalUrl" class="form-input" required placeholder="https://hotel.nevron.app">
              <div class="form-error" id="err-portalUrl">Portal URL is required</div>
            </div>
            <div class="form-group">
              <label class="form-label" for="otaRating">OTA Rating (optional)</label>
              <input type="number" id="otaRating" class="form-input" step="0.1" min="1" max="10" placeholder="8.4">
              <div class="form-hint">Booking.com or Google rating for ROI projection.</div>
            </div>
            <div class="form-group">
              <label class="form-label">Has Competitor Guest App?</label>
              <div class="toggle-group">
                <div class="toggle-option"><input type="radio" name="hasCompetitor" id="compNo" value="no" checked><label for="compNo">No</label></div>
                <div class="toggle-option"><input type="radio" name="hasCompetitor" id="compYes" value="yes"><label for="compYes">Yes</label></div>
              </div>
              <div class="conditional-field" id="competitor-field">
                <input type="text" id="competitorName" class="form-input" placeholder="Competitor app name">
              </div>
            </div>
          </div>

          <!-- CONTACT INFO -->
          <div class="form-card green">
            <div class="form-card-title"><div class="form-card-icon">&#128100;</div> Contact Info</div>

            <div class="form-group">
              <label class="form-label" for="contactName">Contact Name *</label>
              <input type="text" id="contactName" class="form-input" required placeholder="Maja Novak">
              <div class="form-error" id="err-contactName">Contact name is required</div>
            </div>
            <div class="form-group">
              <label class="form-label" for="role">Role *</label>
              <select id="role" class="form-select" required>
                <option value="gm">General Manager</option>
                <option value="owner">Owner</option>
                <option value="revenue_manager">Revenue Manager</option>
                <option value="it">IT Manager</option>
                <option value="marketing">Marketing Manager</option>
                <option value="front_office">Front Office Manager</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label" for="email">Email *</label>
              <input type="email" id="email" class="form-input" required placeholder="maja@grandhotel.si">
              <div class="form-error" id="err-email">Valid email is required</div>
            </div>
            <div class="form-group">
              <label class="form-label" for="phone">Phone / WhatsApp</label>
              <input type="tel" id="phone" class="form-input" placeholder="+386 40 123 456">
              <div class="form-hint">If provided, WhatsApp and phone touches are included.</div>
            </div>
            <div class="form-group">
              <label class="form-label" for="linkedinUrl">LinkedIn URL</label>
              <input type="url" id="linkedinUrl" class="form-input" placeholder="https://linkedin.com/in/majanovak">
            </div>
            <div class="form-group">
              <label class="form-label" for="linkedinStatus">LinkedIn Status</label>
              <select id="linkedinStatus" class="form-select" disabled>
                <option value="na">N/A</option>
                <option value="not_sent">Not Sent</option>
                <option value="pending">Pending</option>
                <option value="connected">Connected</option>
              </select>
              <div class="form-hint">Enabled when LinkedIn URL is provided.</div>
            </div>
          </div>

          <!-- RELATIONSHIP -->
          <div class="form-card orange">
            <div class="form-card-title"><div class="form-card-icon">&#129309;</div> Relationship</div>

            <div class="form-group">
              <label class="form-label" for="priorInteraction">Prior Interaction</label>
              <select id="priorInteraction" class="form-select">
                <option value="none">None (cold)</option>
                <option value="email_sent">Email sent previously</option>
                <option value="call_made">Call made previously</option>
                <option value="met_at_event">Met at event</option>
                <option value="existing_relationship">Existing relationship</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label" for="interactionNotes">Notes</label>
              <textarea id="interactionNotes" class="form-textarea" disabled placeholder="Details about the prior interaction..."></textarea>
              <div class="form-hint">Enabled when a prior interaction is selected.</div>
            </div>
          </div>
        </div>

        <div class="btn-row" style="justify-content: center;">
          <button type="submit" class="btn btn-primary" id="generate-btn">Generate Outreach Strategy</button>
        </div>
        <p style="text-align:center; margin-top:16px;">
          <a onclick="showGeneralForm()" style="color:var(--text-muted); cursor:pointer; font-size:13px;">Don't have full contact details? <span style="text-decoration:underline;">Use General Outreach</span></a>
        </p>
      </form>
    </div>
  </div>

  <!-- GENERAL FORM VIEW -->
  <div id="general-form-view" style="display:none;">
    <div class="hero">
      <div class="hero-badge">General Outreach</div>
      <h1>General Hotel Outreach</h1>
      <p>Generic email outreach templates are shown below. Fill in any details you have and click Personalize to update the messages.</p>
    </div>

    <div class="container">
      <form id="general-outreach-form" novalidate>

        <div class="lang-bar">
          <div class="lang-toggle">
            <input type="radio" name="gen-lang" id="gen-lang-sl" value="sl" checked>
            <label for="gen-lang-sl">Slovenščina</label>
            <input type="radio" name="gen-lang" id="gen-lang-en" value="en">
            <label for="gen-lang-en">English</label>
          </div>
        </div>

        <div style="max-width:540px; margin:0 auto;">
          <div class="form-card purple">
            <div class="form-card-title"><div class="form-card-icon">&#127976;</div> Personalize</div>

            <div class="form-group">
              <label class="form-label" for="gen-hotelName">Hotel Name</label>
              <input type="text" id="gen-hotelName" class="form-input" placeholder="Grand Hotel Toplice">
            </div>
            <div class="form-group">
              <label class="form-label" for="gen-city">City / Location</label>
              <input type="text" id="gen-city" class="form-input" placeholder="Bled, Slovenia">
            </div>
            <div class="form-group">
              <label class="form-label" for="gen-portalUrl">Portal / PWA URL</label>
              <input type="url" id="gen-portalUrl" class="form-input" placeholder="https://hotel.nevron.app">
            </div>
            <div class="form-group">
              <label class="form-label" for="gen-contactName">Contact Name</label>
              <input type="text" id="gen-contactName" class="form-input" placeholder="Maja">
            </div>
          </div>
        </div>

        <div class="btn-row" style="justify-content: center;">
          <button type="submit" class="btn btn-primary">Personalize</button>
        </div>
        <p style="text-align:center; margin-top:16px;">
          <a onclick="showForm()" style="color:var(--text-muted); cursor:pointer; font-size:13px;">Need full personalization? <span style="text-decoration:underline;">Use Detailed Strategy</span></a>
        </p>
      </form>
    </div>
  </div>

  <!-- OUTPUT VIEW -->
  <div id="output-view" style="display:none;">
    <div class="hero" id="output-hero">
      <div class="hero-badge">Generated Strategy</div>
      <h1 id="output-title"></h1>
      <p id="output-subtitle"></p>
    </div>
    <div class="container">
      <section id="summary-section">
        <div class="section-label purple">Summary</div>
        <div class="section-title">Strategy Overview</div>
        <div id="summary-content"></div>
      </section>

      <section class="section-divider" id="timeline-section">
        <div class="section-label blue">Timeline</div>
        <div class="section-title">21-Day Sequence</div>
        <div class="section-desc">Three phases across 21 days. Only channels available for this contact are shown.</div>
        <div id="timeline-content"></div>
      </section>

      <section class="section-divider" id="messages-section">
        <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:12px;">
          <div>
            <div class="section-label green">Messages</div>
            <div class="section-title">Touchpoint Messages</div>
          </div>
          <button class="btn btn-secondary btn-sm no-print" onclick="copyAll()">Copy All Messages</button>
        </div>
        <div id="messages-content"></div>
      </section>

      <section class="section-divider" id="roi-section">
        <div class="section-label orange">ROI Projection</div>
        <div class="section-title">Estimated Annual Benefit</div>
        <div class="section-desc">Conservative projections based on Nevron case study data (+13% revenue across deployments) and the industry benchmark: 0.1 rating improvement = EUR 10 more per room per night.</div>
        <div id="roi-content"></div>
      </section>

      <section class="section-divider" id="loom-section">
        <div class="section-label pink">Video Walkthrough</div>
        <div class="section-title">Loom Recording Script</div>
        <div class="section-desc">Record a 90 second personalized video walkthrough. Referenced in the Day 5 email. Personalized video drives 5x higher click through rates.</div>
        <div id="loom-content"></div>
      </section>

      <section class="section-divider" id="checklist-section">
        <div class="section-label red">Tracking</div>
        <div class="section-title">Execution Checklist</div>
        <div class="section-desc">Track each touchpoint as you execute. Progress saves automatically per hotel.</div>
        <div id="checklist-content"></div>
      </section>

      <div class="btn-row no-print" style="justify-content: center; margin: 60px 0 20px;">
        <button class="btn btn-secondary" onclick="editInputs()">Edit Inputs</button>
        <button class="btn btn-primary" onclick="window.print()">Print Strategy</button>
      </div>
    </div>
    <div class="footer">
      Nevron Hotel Outreach Generator &middot; Generated on <span id="gen-date"></span>
    </div>
  </div>

</div>

<div class="toast" id="toast"></div>

<script>
(function() {
  'use strict';

  // ============================================================
  // CONSTANTS
  // ============================================================
  const ADR_BY_STARS = { 3: 80, 4: 140, 5: 250 };
  const OCCUPANCY = 0.65;

  const ROLE_LABELS = {
    gm: 'General Manager', owner: 'Owner', revenue_manager: 'Revenue Manager',
    it: 'IT Manager', marketing: 'Marketing Manager', front_office: 'Front Office Manager'
  };

  // English role data
  const EN = {
    valueProp: {
      gm: 'streamline operations and elevate guest satisfaction',
      owner: 'drive direct revenue and reduce OTA dependency',
      revenue_manager: 'boost RevPAR and optimize revenue per guest',
      it: 'deploy a modern, zero maintenance digital guest solution',
      marketing: 'strengthen your brand presence throughout the guest journey',
      front_office: 'reduce repetitive guest inquiries and free up your team'
    },
    metrics: {
      gm: 'guest satisfaction and operational efficiency',
      owner: 'direct revenue and profit margins',
      revenue_manager: 'RevPAR and ancillary revenue',
      it: 'system reliability and maintenance time',
      marketing: 'brand engagement and guest touchpoints',
      front_office: 'front desk inquiry volume and response times'
    },
    feature: {
      gm: 'the real-time guest communication features that reduce front desk questions by up to 30%',
      owner: 'the upsell module where guests can book spa treatments, dining, and experiences directly',
      revenue_manager: 'the analytics dashboard that tracks guest engagement and upsell conversion',
      it: 'the zero maintenance PWA architecture: no app store updates, no device compatibility issues',
      marketing: 'the branded experience your guests get, from local recommendations to personalized welcome messages',
      front_office: 'the area guide and FAQ section that answers the questions your team gets asked every day'
    },
    roleFrame: {
      owner: 'For you as the owner, the key number is the direct revenue potential.',
      revenue_manager: 'From a revenue management perspective, these numbers flow directly into your RevPAR.',
      gm: 'For your property, these improvements would be visible across guest satisfaction and operational metrics.',
      it: 'The portal runs as a PWA with zero server maintenance on your side.',
      marketing: 'These touchpoints give your marketing team direct control over the guest experience narrative.',
      front_office: 'These improvements would directly impact your day to day operations.'
    },
    warmCtx: {
      email_sent: 'I reached out via email previously',
      call_made: 'we spoke briefly on the phone',
      met_at_event: 'we met at the event',
      existing_relationship: 'we have been in touch'
    }
  };

  // Slovenian role data
  const SL = {
    valueProp: {
      gm: 'poenostaviti operativno delo in dvigniti zadovoljstvo gostov',
      owner: 'povečati neposredne prihodke in zmanjšati odvisnost od OTA platform',
      revenue_manager: 'dvigniti RevPAR in optimizirati prihodek na gosta',
      it: 'uvesti moderno digitalno rešitev brez vzdrževanja',
      marketing: 'okrepiti prisotnost Vaše blagovne znamke skozi celotno izkušnjo gosta',
      front_office: 'zmanjšati ponavljajoča se vprašanja gostov in razbremeniti Vašo ekipo'
    },
    metrics: {
      gm: 'zadovoljstva gostov in operativne učinkovitosti',
      owner: 'neposrednih prihodkov in donosnosti',
      revenue_manager: 'RevPAR in dodatnih prihodkov',
      it: 'zanesljivosti sistema in časa vzdrževanja',
      marketing: 'angažiranosti blagovne znamke in stičnih točk z gosti',
      front_office: 'obsega povpraševanj na recepciji in odzivnosti'
    },
    feature: {
      gm: 'funkcije za komunikacijo z gosti v realnem času, ki zmanjšajo vprašanja na recepciji za do 30 %',
      owner: 'modul za dodatno prodajo, kjer gostje neposredno rezervirajo spa tretmaje, obroke in aktivnosti',
      revenue_manager: 'analitično nadzorno ploščo za spremljanje angažiranosti gostov in konverzij dodatne prodaje',
      it: 'arhitekturo PWA brez vzdrževanja: ni posodobitev v trgovinah, ni težav z združljivostjo naprav',
      marketing: 'izkušnjo z Vašo blagovno znamko, od lokalnih priporočil do prilagojenih pozdravnih sporočil',
      front_office: 'vodič po okolici in odgovore na pogosta vprašanja, ki jih Vaša ekipa sliši vsak dan'
    },
    roleFrame: {
      owner: 'Za Vas kot lastnika je ključna številka potencial neposrednih prihodkov.',
      revenue_manager: 'Z vidika upravljanja prihodkov te številke neposredno vplivajo na Vaš RevPAR.',
      gm: 'Za Vašo nepremičnino bi bile te izboljšave vidne tako pri zadovoljstvu gostov kot pri operativnih kazalnikih.',
      it: 'Portal deluje kot PWA brez vzdrževanja strežnika na Vaši strani.',
      marketing: 'Te stične točke Vaši marketinški ekipi omogočajo neposreden nadzor nad zgodbo izkušnje gosta.',
      front_office: 'Te izboljšave bi neposredno vplivale na Vaše vsakodnevno delo.'
    },
    warmCtx: {
      email_sent: 'pred časom sem Vam že pisal',
      call_made: 'pred kratkim sva se na kratko slišala po telefonu',
      met_at_event: 'spoznala sva se na dogodku',
      existing_relationship: 'sva že v stiku'
    }
  };

  const CASE_STUDIES = {
    boutique: { name: 'Carana Beach Resort', location: 'Sejšeli', rooms: 40, result_en: 'continuous upgrades since 2016, +13% revenue', result_sl: 'neprekinjene nadgradnje od leta 2016, +13 % prihodkov' },
    standard: { name: 'The Fives Oceanfront', location: 'Mehika', rooms: 84, result_en: '+13% revenue increase, real time digital signage', result_sl: '+13 % rast prihodkov, digitalno obvestilno oglaševanje' },
    enterprise: { name: 'Edgewater Resort & Spa', location: 'Cookovi otoki', rooms: 280, result_en: '+13% revenue increase, reduced front desk inquiries', result_sl: '+13 % rast prihodkov, zmanjšanje povpraševanj na recepciji' }
  };

  const CHANNEL_ICONS = { email: '\u2709', linkedin: '\uD83D\uDCBC', whatsapp: '\uD83D\uDCAC', phone: '\uD83D\uDCDE' };

  // ============================================================
  // DOM
  // ============================================================
  const formView = document.getElementById('form-view');
  const generalFormView = document.getElementById('general-form-view');
  const outputView = document.getElementById('output-view');
  const form = document.getElementById('outreach-form');
  const generalForm = document.getElementById('general-outreach-form');
  const toast = document.getElementById('toast');
  let isGeneralMode = false;

  // ============================================================
  // CONDITIONAL FIELDS
  // ============================================================
  document.querySelectorAll('input[name="hasCompetitor"]').forEach(r => {
    r.addEventListener('change', () => {
      document.getElementById('competitor-field').classList.toggle('visible', r.value === 'yes' && r.checked);
    });
  });
  document.getElementById('linkedinUrl').addEventListener('input', function() {
    const sel = document.getElementById('linkedinStatus');
    if (this.value.trim()) { sel.disabled = false; if (sel.value === 'na') sel.value = 'not_sent'; }
    else { sel.disabled = true; sel.value = 'na'; }
  });
  document.getElementById('priorInteraction').addEventListener('change', function() {
    document.getElementById('interactionNotes').disabled = this.value === 'none';
  });
  // Auto-regenerate general outreach when language changes
  document.querySelectorAll('input[name="gen-lang"]').forEach(r => {
    r.addEventListener('change', function() {
      if (isGeneralMode) generateGeneral(getGeneralFormData());
    });
  });

  // ============================================================
  // FORM DATA
  // ============================================================
  function getFormData() {
    const starR = document.querySelector('input[name="starRating"]:checked');
    const compR = document.querySelector('input[name="hasCompetitor"]:checked');
    const langR = document.querySelector('input[name="lang"]:checked');
    return {
      hotelName: document.getElementById('hotelName').value.trim(),
      city: document.getElementById('city').value.trim(),
      roomCount: parseInt(document.getElementById('roomCount').value) || 0,
      starRating: starR ? parseInt(starR.value) : 4,
      portalUrl: document.getElementById('portalUrl').value.trim(),
      otaRating: parseFloat(document.getElementById('otaRating').value) || null,
      hasCompetitor: compR ? compR.value === 'yes' : false,
      competitorName: document.getElementById('competitorName').value.trim(),
      contactName: document.getElementById('contactName').value.trim(),
      role: document.getElementById('role').value,
      email: document.getElementById('email').value.trim(),
      phone: document.getElementById('phone').value.trim(),
      linkedinUrl: document.getElementById('linkedinUrl').value.trim(),
      linkedinStatus: document.getElementById('linkedinStatus').value,
      priorInteraction: document.getElementById('priorInteraction').value,
      interactionNotes: document.getElementById('interactionNotes').value.trim(),
      lang: langR ? langR.value : 'sl'
    };
  }

  function setFormData(d) {
    if (!d) return;
    const fields = ['hotelName','city','roomCount','portalUrl','otaRating','competitorName','contactName','email','phone','linkedinUrl'];
    fields.forEach(f => { if (d[f]) document.getElementById(f).value = d[f]; });
    if (d.starRating) { const r = document.getElementById('star' + d.starRating); if (r) r.checked = true; }
    if (d.hasCompetitor) { document.getElementById('compYes').checked = true; document.getElementById('competitor-field').classList.add('visible'); }
    if (d.role) document.getElementById('role').value = d.role;
    if (d.linkedinUrl) { document.getElementById('linkedinStatus').disabled = false; }
    if (d.linkedinStatus) document.getElementById('linkedinStatus').value = d.linkedinStatus;
    if (d.priorInteraction) { document.getElementById('priorInteraction').value = d.priorInteraction; document.getElementById('interactionNotes').disabled = d.priorInteraction === 'none'; }
    if (d.interactionNotes) document.getElementById('interactionNotes').value = d.interactionNotes;
    if (d.lang) { const r = document.getElementById('lang-' + d.lang); if (r) r.checked = true; }
  }

  function saveFormData(d) { try { localStorage.setItem('hotelOutreachForm', JSON.stringify(d)); } catch(e) {} }
  function loadFormData() { try { const r = localStorage.getItem('hotelOutreachForm'); return r ? JSON.parse(r) : null; } catch(e) { return null; } }

  function loadFromUrlParams() {
    const p = new URLSearchParams(window.location.search);
    const map = { hotel:'hotelName', city:'city', rooms:'roomCount', stars:'starRating', portal:'portalUrl', ota:'otaRating', competitor:'competitorName', contact:'contactName', role:'role', email:'email', phone:'phone', linkedin:'linkedinUrl', linkedin_status:'linkedinStatus', interaction:'priorInteraction', notes:'interactionNotes', lang:'lang' };
    const d = {}; let has = false;
    for (const [k,v] of Object.entries(map)) { const val = p.get(k); if (val) { d[v] = val; has = true; } }
    if (p.get('competitor')) d.hasCompetitor = true;
    if (d.roomCount) d.roomCount = parseInt(d.roomCount);
    if (d.starRating) d.starRating = parseInt(d.starRating);
    if (d.otaRating) d.otaRating = parseFloat(d.otaRating);
    return has ? d : null;
  }

  // ============================================================
  // VALIDATION
  // ============================================================
  function validate(d) {
    let ok = true;
    ['hotelName','city','roomCount','portalUrl','contactName','email'].forEach(f => {
      const el = document.getElementById(f), err = document.getElementById('err-' + f);
      if (!d[f] || (f === 'roomCount' && d[f] < 1)) { el.classList.add('error'); if (err) err.classList.add('show'); ok = false; }
      else { el.classList.remove('error'); if (err) err.classList.remove('show'); }
    });
    return ok;
  }

  // ============================================================
  // DERIVED
  // ============================================================
  function derive(d) {
    const lang = d.lang || 'sl';
    const L = lang === 'sl' ? SL : EN;
    const firstName = d.contactName.split(' ')[0];
    const segment = d.roomCount < 50 ? 'boutique' : d.roomCount <= 150 ? 'standard' : 'enterprise';
    const segLabel = segment === 'boutique' ? 'Boutique' : segment === 'standard' ? 'Mid-size' : 'Large';
    const hasPhone = !!d.phone;
    const hasLinkedIn = !!d.linkedinUrl;
    const isWarm = ['call_made','met_at_event','existing_relationship'].includes(d.priorInteraction);
    const isConnected = d.linkedinStatus === 'connected';
    const adr = ADR_BY_STARS[d.starRating] || 140;
    const annualRoomNights = d.roomCount * 365 * OCCUPANCY;
    const cs = CASE_STUDIES[segment];
    const csResult = lang === 'sl' ? cs.result_sl : cs.result_en;

    let warmCtx = '';
    if (d.priorInteraction !== 'none' && L.warmCtx[d.priorInteraction]) {
      warmCtx = L.warmCtx[d.priorInteraction];
      if (d.priorInteraction === 'met_at_event' && d.interactionNotes) warmCtx += ' (' + d.interactionNotes + ')';
    }

    return {
      lang, L, firstName, segment, segLabel, hasPhone, hasLinkedIn, isWarm, isConnected,
      adr, annualRoomNights, cs, csResult, warmCtx,
      prop: L.valueProp[d.role] || L.valueProp.gm,
      metrics: L.metrics[d.role] || L.metrics.gm,
      feature: L.feature[d.role] || L.feature.gm,
      frame: L.roleFrame[d.role] || L.roleFrame.gm,
      roleLabel: ROLE_LABELS[d.role] || 'General Manager'
    };
  }

  // ============================================================
  // ENGLISH MESSAGES
  // ============================================================
  function genEN(d, v) {
    const m = [];
    const hn = d.hotelName, fn = v.firstName, url = d.portalUrl;

    // Day 1 Email
    { let subj, body;
      if (d.hasCompetitor && d.competitorName) {
        subj = `A different approach for ${hn}'s guest experience`;
        body = v.isWarm
          ? `Hi ${fn},\n\n${cap(v.warmCtx)}, and I wanted to follow up with something I built for ${hn}.\n\nI noticed you currently use ${d.competitorName} for your guest experience. I took a different approach and built a digital guest portal specifically for ${hn}: ${url}\n\nIt focuses on helping you ${v.prop}, with features like an interactive area guide, direct communication tools, and personalized recommendations.\n\nNo strings attached. It is yours to explore and compare.\n\nIf you see potential, I would love to show you the full version with your branding and live integrations.\n\nBest,\nRok`
          : `Hi ${fn},\n\nI noticed ${hn} uses ${d.competitorName} for guest engagement. I took a different approach and built a digital guest portal specifically for your property: ${url}\n\nIt already includes your hotel information, area guide, and local recommendations. The focus is on helping you ${v.prop}.\n\nNo strings attached. Just have a look and see how it compares.\n\nIf you would like to see the full version with your branding and live booking integration, I am happy to show you.\n\nBest,\nRok`;
      } else {
        subj = `I built ${hn}'s guest portal app`;
        body = v.isWarm
          ? `Hi ${fn},\n\n${cap(v.warmCtx)}, and I have something new to share.\n\nI built a digital guest portal specifically for ${hn}: ${url}\n\nIt already includes your hotel information, room details, and local recommendations. Guests can install it on their phone in one tap.\n\nThe goal is to help you ${v.prop}. No strings attached, it is yours to explore.\n\nIf you would like to see the full version with your branding and live integrations, I would love to walk you through it.\n\nBest,\nRok`
          : `Hi ${fn},\n\nI noticed ${hn} does not have a digital guest portal, so I went ahead and built one for you: ${url}\n\nIt already includes your hotel information, room details, and local recommendations. Guests can install it on their phone in one tap.\n\nNo strings attached. It is yours to explore.\n\nIf you would like to see what it looks like with your full branding and live booking integration, I would love to show you. But for now, just have a look.\n\nBest,\nRok`;
      }
      m.push({ day:1, channel:'email', phase:'reveal', purpose:'Value Reveal', subject:subj, body });
    }

    // Day 2 LinkedIn
    if (v.hasLinkedIn) {
      const body = v.isConnected
        ? `Hi ${fn}, I sent you something via email that I think ${hn} would find interesting. It is a digital guest portal I built specifically for your property. Would love your thoughts on it.`
        : `Hi ${fn}, I work with hotels on digital guest experiences. I sent something over via email that I think ${hn} would find valuable. Would love to connect.`;
      m.push({ day:2, channel:'linkedin', phase:'reveal', purpose: v.isConnected ? 'Direct Message' : 'Connection Request', subject:null, body, note: v.isConnected ? 'Send as a LinkedIn DM.' : 'Send as connection request note (max 300 chars).' });
    }

    // Day 3 WhatsApp
    if (v.hasPhone) {
      m.push({ day:3, channel:'whatsapp', phase:'reveal', purpose:'Initial Message + Portal Link', subject:null,
        body: `Hi ${fn}, this is Rok from Nevron.\n\nI built a digital guest portal specifically for ${hn} and wanted to share it with you: ${url}\n\nIt works like an app your guests can install on their phones. Already has your hotel info, area guide, and recommendations.\n\nWould love your thoughts on it.\n\n(Reply STOP to opt out)` });
    }

    // Day 5 Email
    m.push({ day:5, channel:'email', phase:'reveal', purpose:'Video Walkthrough Reference',
      subject: `90 seconds of ${hn}'s new guest app`,
      body: `Hi ${fn},\n\nI ${v.isWarm ? 'shared' : 'sent you'} ${hn}'s guest portal ${v.isWarm ? 'earlier this week' : 'a few days ago'}. In case you have not had a chance to explore it, I recorded a quick 90 second walkthrough: [VIDEO LINK]\n\nIt shows how your guests would use it to find restaurant recommendations, book activities, and navigate the ${d.city} area.\n\nHappy to answer any questions.\n\nBest,\nRok` });

    // Day 7 Phone
    if (v.hasPhone) {
      m.push({ day:7, channel:'phone', phase:'value', purpose:'Warm Follow-up Call', subject:null,
        body: `OPENING:\n"Hi ${fn}, this is Rok from Nevron. I sent you ${hn}'s guest portal app earlier this week. I wanted to check in and see if you had a chance to look at it."\n\nIF THEY SAW IT:\n"Great! What did you think? [Listen] I built that using your publicly available information, but imagine what it could look like with your full branding, live booking integration, and custom recommendations. Would it make sense to spend 15 minutes showing you the full version?"\n\nIF THEY DID NOT SEE IT:\n"No problem at all. In short, I built a digital guest portal specifically for ${hn}. Your guests can install it on their phones and use it to find everything about your hotel and ${d.city}. Let me resend it. Would you have 15 minutes this week for a quick walkthrough?"\n\nIF THEY PUSH BACK:\n"I completely understand. The portal is live at ${url}. If you do take a look and want to discuss, I am always available."`,
        note: 'Best call times: Tue to Thu, 10:00 to 11:30 or 14:00 to 15:30. Avoid check-in rush. Most calls go to voicemail; leave a 30 sec message.' });
    }

    // Day 8 Email
    m.push({ day:8, channel:'email', phase:'value', purpose:'Social Proof (Case Studies)',
      subject: `How a ${v.cs.rooms} room ${v.segLabel.toLowerCase()} resort uses their guest portal`,
      body: `Hi ${fn},\n\n${v.cs.name} in ${v.cs.location} started using a Nevron digital guest portal. Here is what changed:\n\n- ${v.csResult}\n- Reduced guest inquiries at front desk\n- Marketing team actively using the platform for content updates\n\nYour portal for ${hn} is already built and ready. Would a 15 minute call next week make sense to discuss what is possible for improving ${v.metrics}?\n\nBest,\nRok` });

    // Day 10 WhatsApp
    if (v.hasPhone) {
      m.push({ day:10, channel:'whatsapp', phase:'value', purpose:'Feature Value Drop', subject:null,
        body: `Hi ${fn}, quick update on the ${hn} portal.\n\nDid you know your guests can use it to explore ${v.feature}?\n\nThis kind of feature reduced front desk questions by 30% at hotels using similar portals.\n\nHappy to walk you through more if interested.` });
    }

    // Day 12 LinkedIn
    if (v.hasLinkedIn) {
      m.push({ day:12, channel:'linkedin', phase:'value', purpose:'Content Share / Insight', subject:null,
        body: `Hi ${fn}, I came across an interesting insight about digital guest experience trends and thought of ${hn}.\n\n[Share relevant article or insight]\n\nCurious if this aligns with what you are seeing at your property. The portal I built for ${hn} addresses several of these trends directly.`,
        note: 'Find a relevant hotel tech article. Engage with their recent LinkedIn activity before sending.' });
    }

    // Day 14 Email
    { const rr = Math.round(d.roomCount * 365 * OCCUPANCY * 10);
      const roiLine = d.otaRating
        ? `With ${d.roomCount} rooms and your current ${d.otaRating} rating, even a 0.1 point improvement translates to approximately EUR ${rr.toLocaleString()} in additional annual revenue.\n\n`
        : `With ${d.roomCount} rooms, a 0.1 point improvement in your online rating translates to approximately EUR ${rr.toLocaleString()} in additional annual revenue.\n\n`;
      m.push({ day:14, channel:'email', phase:'value', purpose:'ROI Focus + Meeting Ask',
        subject: `The numbers behind ${hn}'s guest portal`,
        body: `Hi ${fn},\n\nHotels with digital guest portals typically see:\n\n- Rating improvement leading to higher ADR\n- 2 to 5% increase in upsell revenue (spa, dining, experiences)\n- 20 to 30% reduction in repetitive front desk inquiries\n\n${roiLine}${v.frame}\n\nI would love to calculate what this means specifically for ${hn}. To do that accurately, I would just need 15 minutes of your time.\n\nWould any day next week work?\n\nBest,\nRok` });
    }

    // Day 16 Phone
    if (v.hasPhone) {
      m.push({ day:16, channel:'phone', phase:'conversion', purpose:'Second Call Attempt', subject:null,
        body: `OPENING:\n"Hi ${fn}, it is Rok from Nevron. I have been sharing ${hn}'s guest portal over the past couple of weeks. Have you had a chance to explore it?"\n\nKEY POINTS:\n- Reference specific features relevant to their role as ${v.roleLabel}\n- Mention the case study: "${v.cs.name} saw ${v.csResult}"\n- Ask for a 15 minute video call\n- If timing is bad, ask when would be better\n\nVOICEMAIL:\n"Hi ${fn}, it is Rok from Nevron. Just following up on the guest portal for ${hn}. I have interesting data on how similar properties use theirs. Would love 15 minutes. I will send available times via email."`,
        note: 'If you could not reach them on Day 7, this is attempt #2.' });
    }

    // Day 17 Email
    { let subj, body;
      if (d.hasCompetitor && d.competitorName) {
        subj = `${hn}'s portal vs. ${d.competitorName}: a side by side look`;
        body = `Hi ${fn},\n\nI know ${hn} currently uses ${d.competitorName}. I put together the portal specifically to show you a different approach.\n\nWhat the current portal already includes:\n- Your hotel information and room details\n- Interactive ${d.city} area guide\n- Local recommendations and activities\n\nWhat I would love to add (with your input):\n- Your full branding and visual identity\n- Live booking and reservation integration\n- Custom upsell options (spa, dining, experiences)\n- Staff communication tools\n\nWould 15 minutes work to walk through the comparison?\n\nBest,\nRok`;
      } else {
        subj = `Taking ${hn}'s portal to the next level`;
        body = `Hi ${fn},\n\nThe guest portal I built for ${hn} currently uses your publicly available information. Here is what it could look like fully set up:\n\nCurrent version:\n- Hotel information and room details\n- Interactive ${d.city} area guide\n- Local recommendations\n\nFull version (with your input):\n- Your complete branding and visual identity\n- Live booking and reservation integration\n- Personalized guest communication\n- Upsell modules (spa, dining, experiences)\n- Staff dashboard and content management\n\nI would love to add your full branding and make this truly yours. Would 15 minutes work?\n\nBest,\nRok`;
      }
      m.push({ day:17, channel:'email', phase:'conversion', purpose:'Offer to Enhance Portal', subject:subj, body });
    }

    // Day 19 WhatsApp voice note
    if (v.hasPhone) {
      m.push({ day:19, channel:'whatsapp', phase:'conversion', purpose:'Personal Voice Note', subject:null,
        body: `VOICE NOTE SCRIPT (30 to 45 seconds):\n\n"Hi ${fn}, it is Rok. I just wanted to follow up on the guest portal I built for ${hn}. I know you are busy, so I will keep this short. I would love just 15 minutes of your time to show you the full potential of what this can do for your guests and your team. Would any time this week or next work for a quick video call? Let me know, and I will send over a calendar link. Thanks!"`,
        note: 'Record as a WhatsApp voice note, not text. Voice notes feel personal and get high engagement.' });
    }

    // Day 21 Email
    m.push({ day:21, channel:'email', phase:'conversion', purpose:'Breakup: "Should I Close the Portal?"',
      subject: `Should I close ${hn}'s portal?`,
      body: `Hi ${fn},\n\nI built a guest portal for ${hn} a few weeks ago and shared it with you, but I have not heard back.\n\nTotally understand if the timing is not right. The portal will stay live for now, so you can explore it whenever it makes sense: ${url}\n\nIf this is something ${hn} might consider in the future, just let me know and I will keep you updated with what other hotels are doing with theirs.\n\nBest,\nRok`,
      note: 'The "Should I close this?" framing triggers loss aversion. Most effective breakup email format.' });

    return m;
  }

  // ============================================================
  // SLOVENIAN MESSAGES
  // ============================================================
  function genSL(d, v) {
    const m = [];
    const hn = d.hotelName, fn = v.firstName, url = d.portalUrl;

    // Dan 1 Email
    { let subj, body;
      if (d.hasCompetitor && d.competitorName) {
        subj = `Drugačen pristop k izkušnji gostov hotela ${hn}`;
        body = v.isWarm
          ? `Pozdravljeni ${fn},\n\n${cap(v.warmCtx)}, in želel sem nadaljevati s projektom, ki sem ga pripravil za ${hn}.\n\nOpazil sem, da trenutno za digitalno izkušnjo gostov uporabljate ${d.competitorName}. Pripravil sem drugačen pristop in ustvaril portal za goste posebej za Vaš hotel: ${url}\n\nOsredotočen je na to, da Vam pomaga ${v.prop}, z interaktivnim vodnikom po okolici, orodji za komunikacijo in prilagojenimi priporočili za goste.\n\nBrez kakršnihkoli obveznosti. Oglejte si ga in primerjajte.\n\nČe vidite potencial, Vam z veseljem pokažem polno različico z Vašo blagovno znamko in integracijami.\n\nLep pozdrav,\nRok`
          : `Pozdravljeni ${fn},\n\nopazil sem, da ${hn} za komunikacijo z gosti uporablja ${d.competitorName}. Pripravil sem drugačen pristop in ustvaril portal za goste posebej za Vaš hotel: ${url}\n\nŽe vključuje podatke o hotelu, vodič po okolici in lokalna priporočila. Zasnovan je tako, da Vam pomaga ${v.prop}.\n\nBrez kakršnihkoli obveznosti. Oglejte si ga in primerjajte.\n\nČe bi želeli videti polno različico z Vašo blagovno znamko in povezavo z rezervacijskim sistemom, Vam jo z veseljem pokažem.\n\nLep pozdrav,\nRok`;
      } else {
        subj = `Portal za goste hotela ${hn}`;
        body = v.isWarm
          ? `Pozdravljeni ${fn},\n\n${cap(v.warmCtx)}, in imam za Vas nekaj novega.\n\nPripravil sem digitalni portal za goste posebej za ${hn}: ${url}\n\nŽe vključuje informacije o Vašem hotelu, podatke o sobah in lokalna priporočila. Gostje si ga na telefon naložijo z enim klikom.\n\nCilj je pomagati Vam ${v.prop}. Brez kakršnihkoli obveznosti, portal je Vaš.\n\nČe bi želeli videti polno različico z Vašo grafično podobo in integracijami, Vam jo z veseljem predstavim.\n\nLep pozdrav,\nRok`
          : `Pozdravljeni ${fn},\n\nopazil sem, da ${hn} nima digitalnega portala za goste, zato sem ga pripravil: ${url}\n\nŽe vključuje informacije o Vašem hotelu, podrobnosti o sobah in priporočila za okolico. Gostje si ga na telefon naložijo z enim klikom.\n\nBrez kakršnihkoli obveznosti, preprosto si ga oglejte.\n\nČe bi želeli videti različico z Vašo celostno grafično podobo in povezavo z rezervacijskim sistemom, Vam jo z veseljem predstavim. Za zdaj si portal le oglejte.\n\nLep pozdrav,\nRok`;
      }
      m.push({ day:1, channel:'email', phase:'reveal', purpose:'Predstavitev portala', subject:subj, body });
    }

    // Dan 2 LinkedIn
    if (v.hasLinkedIn) {
      const body = v.isConnected
        ? `Pozdravljeni ${fn}, po e-pošti sem Vam poslal digitalni portal za goste, ki sem ga pripravil posebej za ${hn}. Me zanima Vaše mnenje.`
        : `Pozdravljeni ${fn}, ukvarjam se z digitalnimi izkušnjami gostov v hotelirstvu. Po e-pošti sem Vam poslal nekaj, kar bi ${hn} utegnilo zanimati. Bi se povezali?`;
      m.push({ day:2, channel:'linkedin', phase:'reveal', purpose: v.isConnected ? 'Neposredno sporočilo' : 'Zahteva za povezavo', subject:null, body, note: v.isConnected ? 'Send as a LinkedIn DM.' : 'Send as connection request note (max 300 chars).' });
    }

    // Dan 3 WhatsApp
    if (v.hasPhone) {
      m.push({ day:3, channel:'whatsapp', phase:'reveal', purpose:'Prvo sporočilo s povezavo', subject:null,
        body: `Pozdravljeni ${fn}, tukaj Rok iz Nevrona.\n\nPripravil sem digitalni portal za goste posebej za ${hn}: ${url}\n\nDeluje kot aplikacija, ki si jo gostje naložijo na telefon. Že vsebuje podatke o hotelu, vodič po okolici in priporočila.\n\nMe zanima Vaše mnenje.\n\n(Odgovorite STOP za odjavo)` });
    }

    // Dan 5 Email
    m.push({ day:5, channel:'email', phase:'reveal', purpose:'Predstavitev z video vodičem',
      subject: `90 sekund: portal za goste hotela ${hn}`,
      body: `Pozdravljeni ${fn},\n\npred nekaj dnevi sem Vam poslal portal za goste hotela ${hn}. Če si ga še niste uspeli ogledati, sem posnel kratek 90-sekundni vodič: [VIDEO LINK]\n\nPrikazuje, kako bi Vaši gostje portal uporabljali za iskanje restavracij, rezervacijo aktivnosti in raziskovanje okolice ${d.city}.\n\nZ veseljem odgovorim na morebitna vprašanja.\n\nLep pozdrav,\nRok` });

    // Dan 7 Phone
    if (v.hasPhone) {
      m.push({ day:7, channel:'phone', phase:'value', purpose:'Klic za nadaljevanje', subject:null,
        body: `UVOD:\n"Pozdravljeni ${fn}, tukaj Rok iz Nevrona. Pred kratkim sem Vam poslal portal za goste hotela ${hn}. Želel sem preveriti, ali ste imeli priložnost, da si ga ogledate."\n\nČE SO GA VIDELI:\n"Odlično! Kaj menite? [Poslušajte] Ta različica je pripravljena na podlagi javno dostopnih podatkov. Predstavljajte si, kako bi izgledal z Vašo celostno grafično podobo, povezavo z rezervacijskim sistemom in prilagojenimi priporočili. Bi se splačalo, da si vzamemo 15 minut za predstavitev polne različice?"\n\nČE GA NISO VIDELI:\n"Ni problema. Na kratko: pripravil sem digitalni portal za goste posebej za ${hn}. Gostje si ga namestijo na telefon in z njim najdejo vse o Vašem hotelu in okolici ${d.city}. Naj Vam ga ponovno pošljem? Bi imeli ta teden 15 minut za kratek ogled?"\n\nČE ODKLONIJO:\n"Popolnoma razumem. Portal je na voljo kadarkoli na ${url}. Če si ga boste ogledali in bi se želeli pogovoriti, sem vedno dosegljiv."`,
        note: 'Best call times: Tue to Thu, 10:00 to 11:30 or 14:00 to 15:30. Avoid check-in rush hours.' });
    }

    // Dan 8 Email
    m.push({ day:8, channel:'email', phase:'value', purpose:'Primeri in reference',
      subject: `Kako ${v.cs.name} uporablja portal za goste`,
      body: `Pozdravljeni ${fn},\n\n${v.cs.name} (${v.cs.rooms} sob, ${v.cs.location}) je začel uporabljati Nevronov portal za goste. Rezultati:\n\n- ${v.csResult}\n- Zmanjšanje povpraševanj na recepciji\n- Marketinška ekipa aktivno upravlja vsebine prek platforme\n\nPortal za ${hn} je že pripravljen. Bi se nam splačalo naslednji teden nameniti 15 minut za pogovor o možnostih za izboljšanje ${v.metrics}?\n\nLep pozdrav,\nRok` });

    // Dan 10 WhatsApp
    if (v.hasPhone) {
      m.push({ day:10, channel:'whatsapp', phase:'value', purpose:'Predstavitev funkcionalnosti', subject:null,
        body: `Pozdravljeni ${fn}, kratka novost o portalu hotela ${hn}.\n\nAli ste vedeli, da Vaši gostje lahko prek portala uporabijo ${v.feature}?\n\nPodobna funkcionalnost je pri hotelih z enakim portalom zmanjšala vprašanja na recepciji za 30 %.\n\nZ veseljem Vam pokažem več.` });
    }

    // Dan 12 LinkedIn
    if (v.hasLinkedIn) {
      m.push({ day:12, channel:'linkedin', phase:'value', purpose:'Deljenje vsebine', subject:null,
        body: `Pozdravljeni ${fn}, naletel sem na zanimiv vpogled o trendih digitalne izkušnje gostov v hotelirstvu in pomislil na ${hn}.\n\n[Deli relevanten članek ali vpogled]\n\nMe zanima, ali to sovpada z Vašimi izkušnjami. Portal, ki sem ga pripravil za ${hn}, naslavlja več teh trendov.`,
        note: 'Find a relevant hotel tech article. Engage with their LinkedIn activity before sending.' });
    }

    // Dan 14 Email
    { const rr = Math.round(d.roomCount * 365 * OCCUPANCY * 10);
      const roiLine = d.otaRating
        ? `S ${d.roomCount} sobami in Vašo trenutno oceno ${d.otaRating} že izboljšanje za 0,1 točke pomeni približno ${rr.toLocaleString()} EUR dodatnih letnih prihodkov.\n\n`
        : `S ${d.roomCount} sobami izboljšanje spletne ocene za 0,1 točke pomeni približno ${rr.toLocaleString()} EUR dodatnih letnih prihodkov.\n\n`;
      m.push({ day:14, channel:'email', phase:'value', purpose:'ROI in prošnja za sestanek',
        subject: `Številke za portalom hotela ${hn}`,
        body: `Pozdravljeni ${fn},\n\nhoteli z digitalnim portalom za goste tipično dosežejo:\n\n- Izboljšanje ocene, ki vodi k višjemu ADR\n- 2 do 5 % povečanje prihodkov od dodatnih storitev (spa, restavracija, aktivnosti)\n- 20 do 30 % zmanjšanje ponavljajočih se vprašanj na recepciji\n\n${roiLine}${v.frame}\n\nZ veseljem bi izračunal, kaj to konkretno pomeni za ${hn}. Za natančen izračun bi potreboval le 15 minut Vašega časa.\n\nBi Vam kateri dan naslednji teden ustrezal?\n\nLep pozdrav,\nRok` });
    }

    // Dan 16 Phone
    if (v.hasPhone) {
      m.push({ day:16, channel:'phone', phase:'conversion', purpose:'Drugi klic', subject:null,
        body: `UVOD:\n"Pozdravljeni ${fn}, tukaj Rok iz Nevrona. Zadnji dve tedna sem z Vami delil portal za goste hotela ${hn}. Ste imeli priložnost, da si ga ogledate?"\n\nKLJUČNE TOČKE:\n- Omenite specifične funkcionalnosti za njihovo vlogo (${v.roleLabel})\n- Navedite primer: "${v.cs.name} je dosegel ${v.csResult}"\n- Prosite za 15-minutni video klic\n- Če čas ne ustreza, vprašajte kdaj bi bilo bolje\n\nGLASOVNA POŠTA:\n"Pozdravljeni ${fn}, tukaj Rok iz Nevrona. Sledim portalu za goste, ki sem ga pripravil za ${hn}. Imam nekaj zanimivih podatkov o tem, kako podobni hoteli uporabljajo svoj portal. Z veseljem bi Vam namenil 15 minut. Poslal Vam bom e-pošto z razpoložljivimi termini."`,
        note: 'Attempt #2 if Day 7 call was missed.' });
    }

    // Dan 17 Email
    { let subj, body;
      if (d.hasCompetitor && d.competitorName) {
        subj = `Portal hotela ${hn} v primerjavi z ${d.competitorName}`;
        body = `Pozdravljeni ${fn},\n\nvem, da ${hn} trenutno uporablja ${d.competitorName}. Portal sem pripravil prav zato, da Vam pokažem drugačen pristop.\n\nKaj trenutni portal že vsebuje:\n- Informacije o hotelu in podrobnosti o sobah\n- Interaktivni vodič po okolici ${d.city}\n- Lokalna priporočila in aktivnosti\n\nKaj bi z veseljem dodal (z Vašim sodelovanjem):\n- Vašo celostno grafično podobo\n- Povezavo z rezervacijskim sistemom\n- Prilagojene možnosti za dodatno prodajo\n- Orodja za komunikacijo z osebjem\n\nBi imeli 15 minut za primerjavo?\n\nLep pozdrav,\nRok`;
      } else {
        subj = `Nadgradnja portala hotela ${hn}`;
        body = `Pozdravljeni ${fn},\n\nportal za goste hotela ${hn} trenutno temelji na javno dostopnih podatkih. Takole bi lahko izgledal v polni postavitvi:\n\nTrenutna različica:\n- Informacije o hotelu in sobah\n- Interaktivni vodič po okolici ${d.city}\n- Lokalna priporočila\n\nPolna različica (z Vašim sodelovanjem):\n- Vaša celostna grafična podoba\n- Povezava z rezervacijskim sistemom\n- Prilagojena komunikacija z gosti\n- Moduli za dodatno prodajo (spa, restavracija, aktivnosti)\n- Nadzorna plošča za osebje in upravljanje vsebin\n\nZ veseljem bi dodal Vašo grafično podobo in naredil portal resnično Vašega. Bi imeli 15 minut?\n\nLep pozdrav,\nRok`;
      }
      m.push({ day:17, channel:'email', phase:'conversion', purpose:'Ponudba za nadgradnjo', subject:subj, body });
    }

    // Dan 19 WhatsApp glasovno sporočilo
    if (v.hasPhone) {
      m.push({ day:19, channel:'whatsapp', phase:'conversion', purpose:'Osebno glasovno sporočilo', subject:null,
        body: `SKRIPT ZA GLASOVNO SPOROČILO (30 do 45 sekund):\n\n"Pozdravljeni ${fn}, tukaj Rok. Želel sem se navezati na portal za goste, ki sem ga pripravil za ${hn}. Vem, da ste zaposleni, zato bom kratek. Z veseljem bi si vzel 15 minut in Vam pokazal celoten potencial portala za Vaše goste in Vašo ekipo. Bi imeli čas ta ali naslednji teden za kratek video klic? Sporočite mi in pošljem Vam povezavo za termin. Hvala!"`,
        note: 'Record as a WhatsApp voice note, not text. Voice notes feel personal and get very high engagement.' });
    }

    // Dan 21 Email
    m.push({ day:21, channel:'email', phase:'conversion', purpose:'Zaključno sporočilo',
      subject: `Naj zaključim portal hotela ${hn}?`,
      body: `Pozdravljeni ${fn},\n\npred nekaj tedni sem pripravil portal za goste hotela ${hn} in ga delil z Vami, vendar se nisva uspela povezati.\n\nPopolnoma razumem, če čas ni pravi. Portal za zdaj ostaja aktiven, tako da si ga lahko ogledate, kadarkoli bo primerno: ${url}\n\nČe je to nekaj, kar bi ${hn} utegnil upoštevati v prihodnosti, mi le sporočite in Vas bom obveščal o tem, kaj drugi hoteli počnejo s svojimi portali.\n\nLep pozdrav,\nRok`,
      note: 'The "Should I close the portal?" framing triggers loss aversion. Most effective breakup email format.' });

    return m;
  }

  // ============================================================
  // MESSAGE DISPATCHER
  // ============================================================
  function generateMessages(d, v) {
    return v.lang === 'sl' ? genSL(d, v) : genEN(d, v);
  }

  function cap(s) { return s ? s.charAt(0).toUpperCase() + s.slice(1) : ''; }

  // ============================================================
  // ROI
  // ============================================================
  function calculateROI(d, v) {
    const rn = v.annualRoomNights;
    const ratingRevenue = Math.round(rn * 10);
    const upsellRevenue = Math.round(rn * v.adr * 0.02);
    const opSavings = Math.round(d.roomCount * 12 * 3);
    return { ratingRevenue, upsellRevenue, opSavings, total: ratingRevenue + upsellRevenue + opSavings };
  }

  // ============================================================
  // RENDERING
  // ============================================================
  function renderSummary(d, v, messages) {
    const ch = ['Email'];
    if (v.hasLinkedIn) ch.push('LinkedIn');
    if (v.hasPhone) ch.push('WhatsApp', 'Phone');
    return `<div class="summary-grid">
      <div class="summary-card"><div class="summary-label">Hotel</div><div class="summary-value">${esc(d.hotelName)}<br><small>${esc(d.city)} &middot; ${d.roomCount} rooms &middot; ${d.starRating} star${d.hasCompetitor ? ' &middot; Uses ' + esc(d.competitorName || 'competitor app') : ''}</small></div></div>
      <div class="summary-card"><div class="summary-label">Contact</div><div class="summary-value">${esc(d.contactName)}<br><small>${v.roleLabel} &middot; ${esc(d.email)}${d.phone ? ' &middot; ' + esc(d.phone) : ''}</small></div></div>
      <div class="summary-card"><div class="summary-label">Channels</div><div class="summary-value">${messages.length} touchpoints / 21 days<div class="channel-badges">${ch.map(c => `<span class="channel-badge ${c.toLowerCase()}">${c}</span>`).join('')}</div></div></div>
    </div>`;
  }

  function renderTimeline(messages) {
    const phases = [
      { key: 'reveal', label: 'Reveal', days: '1 \u2013 5' },
      { key: 'value', label: 'Value Demo', days: '7 \u2013 14' },
      { key: 'conversion', label: 'Conversion', days: '16 \u2013 21' }
    ];
    return `<div class="phase-timeline">${phases.map(p => {
      const items = messages.filter(m => m.phase === p.key);
      if (!items.length) return '';
      return `<div class="phase-card">
        <div class="phase-card-header ${p.key}">
          <div class="phase-name">${p.label}</div>
          <div class="phase-days">Days ${p.days}</div>
        </div>
        <div class="phase-items">${items.map(m =>
          `<div class="phase-item">
            <div class="phase-item-day">Day ${m.day}</div>
            <div class="phase-item-channel ${m.channel}">${m.channel}</div>
            <div class="phase-item-purpose">${esc(m.purpose)}</div>
          </div>`
        ).join('')}</div>
      </div>`;
    }).join('')}</div>`;
  }

  function renderMessages(messages) {
    return `<div class="message-cards">${messages.map((m, i) => {
      const subjH = m.subject ? `<div class="message-subject">Subject: ${esc(m.subject)}</div>` : '';
      const noteH = m.note ? `<div class="message-note">${esc(m.note)}</div>` : '';
      return `<div class="message-card ch-${m.channel}" id="msg-${i}">
        <div class="message-card-header">
          <div class="message-channel-icon ${m.channel}">${CHANNEL_ICONS[m.channel]}</div>
          <div class="message-meta">
            <div class="message-meta-top"><span class="message-day">Day ${m.day}</span><span class="message-phase-tag ${m.phase}">${m.phase}</span></div>
            <div class="message-purpose">${esc(m.purpose)}</div>
          </div>
        </div>
        <div class="message-card-body">${subjH}<div class="message-text">${esc(m.body)}</div>${noteH}</div>
        <div class="message-card-footer"><button class="btn btn-copy" onclick="copyMessage(${i})">Copy</button></div>
      </div>`;
    }).join('')}</div>`;
  }

  function renderROI(d, v, roi) {
    let rn = `<div class="callout info" style="margin-top:20px;"><div class="callout-title">Based on Current Rating: ${d.otaRating}</div><div class="callout-text">With a current rating of ${d.otaRating}, there is room for improvement. Even a 0.1 point increase translates to EUR 10 more per room per night across your ${d.roomCount} rooms.</div></div>`;
    return `<div class="kpi-row">
      <div class="kpi kpi-green"><div class="kpi-value green">EUR ${roi.ratingRevenue.toLocaleString()}</div><div class="kpi-label">Rating Uplift Revenue</div></div>
      <div class="kpi kpi-accent"><div class="kpi-value accent">EUR ${roi.upsellRevenue.toLocaleString()}</div><div class="kpi-label">Upsell Revenue</div></div>
      <div class="kpi kpi-blue"><div class="kpi-value blue">EUR ${roi.opSavings.toLocaleString()}</div><div class="kpi-label">Operational Savings</div></div>
      <div class="kpi kpi-orange"><div class="kpi-value orange">EUR ${roi.total.toLocaleString()}</div><div class="kpi-label">Total Annual Benefit</div></div>
    </div>${d.otaRating ? rn : ''}
    <div class="callout" style="margin-top:16px;"><div class="callout-title">Calculation Basis</div><div class="callout-text">
      ${d.roomCount} rooms &times; 365 days &times; ${Math.round(OCCUPANCY*100)}% occupancy = ${Math.round(v.annualRoomNights).toLocaleString()} annual room nights<br>
      Rating uplift: 0.1 improvement &times; EUR 10/room/night &times; ${Math.round(v.annualRoomNights).toLocaleString()} room nights<br>
      Upsell: 2% capture rate on EUR ${v.adr} ADR across ${Math.round(v.annualRoomNights).toLocaleString()} room nights<br>
      Operational: EUR 3/room/month in reduced inquiry handling and print costs<br><br>
      Based on Nevron case studies: Edgewater Resort (+13% revenue, 280 rooms), The Fives Oceanfront (+13% revenue, 84 rooms), Carana Beach Resort (continuous upgrades since 2016).
    </div></div>`;
  }

  function renderLoom(d, v) {
    const isSL = v.lang === 'sl';
    const steps = isSL ? [
      { t: 'Uvod (10 sek)', d: `"Pozdravljeni ${v.firstName}, tukaj Rok iz Nevrona. Pripravil sem digitalni portal za goste hotela ${d.hotelName} in Vam želim na hitro pokazati, kaj zmore."` },
      { t: 'Prikaz portala (30 sek)', d: `Odprite ${d.portalUrl}. Pokažite začetni zaslon, informacije o sobah in vodič po okolici ${d.city} z restavracijami, znamenitostmi in aktivnostmi. Poudarite, kako izgleda na mobilnem telefonu.` },
      { t: 'Ključna funkcionalnost (20 sek)', d: `Osredotočite se na ${v.feature}. Pojasnite, kako to neposredno pomaga ${v.prop}.` },
      { t: 'Referenca (15 sek)', d: `"${v.cs.name}, hotel z ${v.cs.rooms} sobami v lokaciji ${v.cs.location}, je po uvedbi portala dosegel ${v.csResult}."` },
      { t: 'Poziv k akciji (15 sek)', d: `"To je začetna različica. S 15 minutami Vašega časa lahko dodam Vašo celostno grafično podobo, integracijo z rezervacijskim sistemom in prilagojene funkcionalnosti. Bi se splačalo za kratek klic? Preprosto odgovorite na mojo e-pošto."` }
    ] : [
      { t: 'Introduction (10 sec)', d: `"Hi ${v.firstName}, this is Rok from Nevron. I built a digital guest portal for ${d.hotelName} and I want to give you a quick tour of what it can do."` },
      { t: 'Show the Portal (30 sec)', d: `Open ${d.portalUrl}. Walk through the home screen, room information, and the ${d.city} area guide. Point out how it looks on a mobile phone.` },
      { t: 'Key Feature (20 sec)', d: `Focus on ${v.feature}. Explain how this directly helps ${v.prop}.` },
      { t: 'Social Proof (15 sec)', d: `"${v.cs.name}, a ${v.cs.rooms} room property in ${v.cs.location}, saw ${v.csResult} after implementing their portal."` },
      { t: 'Call to Action (15 sec)', d: `"This is the starter version. With 15 minutes of your time, I can add your full branding, live booking integration, and custom features. Would that be worth a quick call? Just reply to my email."` }
    ];
    return `<div class="loom-script">${steps.map((s,i) => `<div class="loom-step"><div class="loom-step-num">${i+1}</div><div class="loom-step-content"><div class="loom-step-title">${s.t}</div><div class="loom-step-desc">${s.d}</div></div></div>`).join('')}</div>
    <div class="callout warn" style="margin-top:16px;"><div class="callout-title">Recording Tips</div><div class="callout-text">Keep it under 90 seconds. Use screen recording with your face in the corner (Loom, Tella, or similar). Smile, be natural. Personalized video drives 5x higher click through rates and 3x response rates.</div></div>`;
  }

  function renderChecklist(messages, hotelName) {
    const saved = loadCL(hotelName);
    return `<div class="checklist-wrap"><table class="checklist-table"><thead><tr><th></th><th>Day</th><th>Channel</th><th>Touchpoint</th><th>Notes</th></tr></thead><tbody>${messages.map((m,i) => {
      const ck = saved[i] ? 'checked' : '';
      const rc = saved[i] ? 'checked' : '';
      return `<tr class="${rc}" id="check-row-${i}"><td><input type="checkbox" class="checklist-cb" data-idx="${i}" ${ck} onchange="toggleCheck(${i},'${escA(hotelName)}')"></td><td>Day ${m.day}</td><td><span class="channel-badge ${m.channel}">${m.channel}</span></td><td>${esc(m.purpose)}</td><td></td></tr>`;
    }).join('')}</tbody></table></div>`;
  }

  // ============================================================
  // CLIPBOARD
  // ============================================================
  let currentMessages = [];

  window.copyMessage = function(i) {
    const m = currentMessages[i]; if (!m) return;
    let t = ''; if (m.subject) t += 'Subject: ' + m.subject + '\n\n'; t += m.body;
    clip(t);
    const b = document.querySelector(`#msg-${i} .btn-copy`);
    if (b) { b.classList.add('copied'); b.textContent = 'Copied!'; setTimeout(() => { b.classList.remove('copied'); b.textContent = 'Copy'; }, 2000); }
  };

  window.copyAll = function() {
    let t = '';
    currentMessages.forEach(m => { t += `--- Day ${m.day} | ${m.channel.toUpperCase()} | ${m.purpose} ---\n`; if (m.subject) t += 'Subject: ' + m.subject + '\n'; t += '\n' + m.body + '\n\n'; });
    clip(t); showToast('All messages copied to clipboard');
  };

  function clip(t) {
    if (navigator.clipboard) navigator.clipboard.writeText(t).catch(() => fbCopy(t));
    else fbCopy(t);
  }
  function fbCopy(t) {
    const a = document.createElement('textarea'); a.value = t; a.style.position = 'fixed'; a.style.left = '-9999px';
    document.body.appendChild(a); a.select(); try { document.execCommand('copy'); } catch(e) {} document.body.removeChild(a);
  }

  // ============================================================
  // CHECKLIST PERSISTENCE
  // ============================================================
  function loadCL(n) { try { const r = localStorage.getItem('hotelChecklist_'+n); return r ? JSON.parse(r) : {}; } catch(e) { return {}; } }
  function saveCL(n, s) { try { localStorage.setItem('hotelChecklist_'+n, JSON.stringify(s)); } catch(e) {} }

  window.toggleCheck = function(i, n) {
    const cb = document.querySelector(`[data-idx="${i}"]`), row = document.getElementById('check-row-'+i);
    const s = loadCL(n);
    if (cb.checked) { s[i] = true; row.classList.add('checked'); } else { delete s[i]; row.classList.remove('checked'); }
    saveCL(n, s);
  };

  // ============================================================
  // UTILS
  // ============================================================
  function esc(s) { const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }
  function escA(s) { return s.replace(/'/g, "\\'").replace(/"/g, '&quot;'); }
  function showToast(m) { toast.textContent = m; toast.classList.add('show'); setTimeout(() => toast.classList.remove('show'), 2500); }

  // ============================================================
  // VIEWS
  // ============================================================
  window.showForm = function() {
    formView.style.display = '';
    generalFormView.style.display = 'none';
    outputView.style.display = 'none';
    document.getElementById('output-hero').style.display = '';
    document.getElementById('nav-links').innerHTML = '<a onclick="showForm()">Detailed Strategy</a><a onclick="showGeneralForm()">General Outreach</a>';
    window.scrollTo(0,0);
  };
  window.showGeneralForm = function() {
    formView.style.display = 'none';
    generalFormView.style.display = '';
    outputView.style.display = '';
    document.getElementById('output-hero').style.display = 'none';
    document.getElementById('nav-links').innerHTML = '<a onclick="showForm()">Detailed Strategy</a><a onclick="showGeneralForm()">General Outreach</a>';
    generateGeneral(getGeneralFormData());
    window.scrollTo(0,0);
  };
  window.editInputs = function() {
    if (isGeneralMode) { window.scrollTo({ top: 0, behavior: 'smooth' }); }
    else showForm();
  };

  // ============================================================
  // GENERATE
  // ============================================================
  function generate(d) {
    const v = derive(d);
    const messages = generateMessages(d, v);
    currentMessages = messages;
    isGeneralMode = false;

    document.getElementById('roi-section').style.display = '';
    document.getElementById('loom-section').style.display = '';
    document.getElementById('output-hero').style.display = '';

    document.getElementById('output-title').textContent = `${d.hotelName} Outreach Strategy`;
    const chCount = (v.hasPhone && v.hasLinkedIn) ? 4 : (v.hasPhone || v.hasLinkedIn) ? (v.hasPhone ? 3 : 2) : 1;
    document.getElementById('output-subtitle').textContent = `Personalized ${messages.length} touchpoint sequence for ${d.contactName} (${v.roleLabel}) across ${chCount} channel${chCount > 1 ? 's' : ''} over 21 days. Language: ${v.lang === 'sl' ? 'Slovenščina' : 'English'}.`;

    document.getElementById('nav-links').innerHTML = `<a onclick="showForm()">Edit Inputs</a><a href="#summary-section">Summary</a><a href="#timeline-section">Timeline</a><a href="#messages-section">Messages</a><a href="#roi-section">ROI</a><a href="#loom-section">Video</a><a href="#checklist-section">Checklist</a>`;

    document.getElementById('summary-content').innerHTML = renderSummary(d, v, messages);
    document.getElementById('timeline-content').innerHTML = renderTimeline(messages);
    document.getElementById('messages-content').innerHTML = renderMessages(messages);
    document.getElementById('roi-content').innerHTML = renderROI(d, v, calculateROI(d, v));
    document.getElementById('loom-content').innerHTML = renderLoom(d, v);
    document.getElementById('checklist-content').innerHTML = renderChecklist(messages, d.hotelName);
    document.getElementById('gen-date').textContent = new Date().toLocaleDateString('en-GB', { day:'numeric', month:'long', year:'numeric' });

    formView.style.display = 'none';
    generalFormView.style.display = 'none';
    outputView.style.display = '';
    window.scrollTo(0, 0);
    saveFormData(d);
  }

  // ============================================================
  // GENERAL OUTREACH MESSAGES (EN)
  // ============================================================
  function genGeneralEN(d) {
    const m = [];
    const hn = d.hotelName, url = d.portalUrl, city = d.city;
    const fn = d.contactName || '';
    const greeting = fn ? `Hi ${fn}` : 'Hello';

    // Day 1 Email
    m.push({ day:1, channel:'email', phase:'reveal', purpose:'Value Reveal',
      subject: `I built ${hn}'s guest portal app`,
      body: `${greeting},\n\nI noticed ${hn} does not have a digital guest portal, so I went ahead and built one: ${url}\n\nIt already includes your hotel information, room details, and local recommendations${city ? ' for the ' + city + ' area' : ''}. Guests can install it on their phone in one tap.\n\nNo strings attached. It is yours to explore.\n\nIf you would like to see what it looks like with your full branding and live booking integration, I would love to show you. But for now, just have a look.\n\nBest,\nRok` });

    // Day 2 LinkedIn
    m.push({ day:2, channel:'linkedin', phase:'reveal', purpose:'Connection Request',
      subject: null,
      body: `${greeting}, I work with hotels on digital guest experiences. I sent something over via email that I think ${hn} would find valuable. Would love to connect.`,
      note: 'Send as connection request note (max 300 chars). If already connected, send as DM instead.' });

    // Day 3 WhatsApp
    m.push({ day:3, channel:'whatsapp', phase:'reveal', purpose:'Initial Message + Portal Link',
      subject: null,
      body: `${greeting}, this is Rok from Nevron.\n\nI built a digital guest portal specifically for ${hn} and wanted to share it with you: ${url}\n\nIt works like an app your guests can install on their phones. Already has your hotel info, area guide, and recommendations.\n\nWould love your thoughts on it.\n\n(Reply STOP to opt out)` });

    // Day 5 Email
    m.push({ day:5, channel:'email', phase:'reveal', purpose:'Video Walkthrough Reference',
      subject: `90 seconds of ${hn}'s new guest app`,
      body: `${greeting},\n\nI sent ${hn}'s guest portal a few days ago. In case you have not had a chance to explore it, I recorded a quick 90 second walkthrough: [VIDEO LINK]\n\nIt shows how your guests would use it to find restaurant recommendations, book activities${city ? ', and navigate the ' + city + ' area' : ', and explore the local area'}.\n\nHappy to answer any questions.\n\nBest,\nRok` });

    // Day 7 Phone
    m.push({ day:7, channel:'phone', phase:'value', purpose:'Warm Follow-up Call',
      subject: null,
      body: `OPENING:\n"${greeting}, this is Rok from Nevron. I sent ${hn}'s guest portal app earlier this week. I wanted to check in and see if you had a chance to look at it."\n\nIF THEY SAW IT:\n"Great! What did you think? [Listen] I built that using publicly available information, but imagine what it could look like with your full branding, live booking integration, and custom recommendations. Would it make sense to spend 15 minutes showing you the full version?"\n\nIF THEY DID NOT SEE IT:\n"No problem at all. In short, I built a digital guest portal specifically for ${hn}. Your guests can install it on their phones and use it to find everything about your hotel${city ? ' and ' + city : ''}. Let me resend it. Would you have 15 minutes this week for a quick walkthrough?"\n\nIF THEY PUSH BACK:\n"I completely understand. The portal is live at ${url}. If you do take a look and want to discuss, I am always available."`,
      note: 'Best call times: Tue to Thu, 10:00 to 11:30 or 14:00 to 15:30. Avoid check-in rush. Most calls go to voicemail; leave a 30 sec message.' });

    // Day 8 Email
    m.push({ day:8, channel:'email', phase:'value', purpose:'Social Proof (Case Studies)',
      subject: 'How hotels use their guest portal to drive revenue',
      body: `${greeting},\n\nHotels using a Nevron digital guest portal typically see:\n\n- +13% revenue increase (across our deployments)\n- Reduced front desk inquiries (up to 30%)\n- Marketing team actively using the platform for content updates\n\nA few examples:\n- Carana Beach Resort (Seychelles, 40 rooms): continuous upgrades since 2016, +13% revenue\n- The Fives Oceanfront (Mexico, 84 rooms): +13% revenue, real time digital signage\n- Edgewater Resort & Spa (Cook Islands, 280 rooms): +13% revenue, reduced front desk inquiries\n\nYour portal for ${hn} is already built and ready: ${url}\n\nWould a 15 minute call make sense to discuss what is possible?\n\nBest,\nRok` });

    // Day 10 WhatsApp
    m.push({ day:10, channel:'whatsapp', phase:'value', purpose:'Feature Value Drop',
      subject: null,
      body: `${greeting}, quick update on the ${hn} portal.\n\nDid you know your guests can use it to explore an interactive area guide, get personalized recommendations, and communicate with your team directly?\n\nThis kind of feature reduced front desk questions by 30% at hotels using similar portals.\n\nHappy to walk you through more if interested.` });

    // Day 12 LinkedIn
    m.push({ day:12, channel:'linkedin', phase:'value', purpose:'Content Share / Insight',
      subject: null,
      body: `${greeting}, I came across an interesting insight about digital guest experience trends and thought of ${hn}.\n\n[Share relevant article or insight]\n\nCurious if this aligns with what you are seeing at your property. The portal I built for ${hn} addresses several of these trends directly.`,
      note: 'Find a relevant hotel tech article. Engage with their recent LinkedIn activity before sending.' });

    // Day 14 Email
    m.push({ day:14, channel:'email', phase:'value', purpose:'ROI Focus + Meeting Ask',
      subject: `The numbers behind ${hn}'s guest portal`,
      body: `${greeting},\n\nHotels with digital guest portals typically see:\n\n- Rating improvement leading to higher ADR\n- 2 to 5% increase in upsell revenue (spa, dining, experiences)\n- 20 to 30% reduction in repetitive front desk inquiries\n\nIndustry benchmark: a 0.1 point rating improvement translates to EUR 10 more per room per night.\n\nI would love to calculate what this means specifically for ${hn}. To do that accurately, I would just need 15 minutes of your time.\n\nWould any day next week work?\n\nBest,\nRok` });

    // Day 16 Phone
    m.push({ day:16, channel:'phone', phase:'conversion', purpose:'Second Call Attempt',
      subject: null,
      body: `OPENING:\n"${greeting}, it is Rok from Nevron. I have been sharing ${hn}'s guest portal over the past couple of weeks. Have you had a chance to explore it?"\n\nKEY POINTS:\n- Reference specific portal features\n- Mention case studies: "Carana Beach Resort saw +13% revenue"\n- Ask for a 15 minute video call\n- If timing is bad, ask when would be better\n\nVOICEMAIL:\n"${greeting}, it is Rok from Nevron. Just following up on the guest portal for ${hn}. I have interesting data on how similar properties use theirs. Would love 15 minutes. I will send available times via email."`,
      note: 'If you could not reach them on Day 7, this is attempt #2.' });

    // Day 17 Email
    m.push({ day:17, channel:'email', phase:'conversion', purpose:'Offer to Enhance Portal',
      subject: `Taking ${hn}'s portal to the next level`,
      body: `${greeting},\n\nThe guest portal I built for ${hn} currently uses publicly available information. Here is what it could look like fully set up:\n\nCurrent version:\n- Hotel information and room details\n- Interactive area guide${city ? ' for ' + city : ''}\n- Local recommendations\n\nFull version (with your input):\n- Your complete branding and visual identity\n- Live booking and reservation integration\n- Personalized guest communication\n- Upsell modules (spa, dining, experiences)\n- Staff dashboard and content management\n\nI would love to add your full branding and make this truly yours. Would 15 minutes work?\n\nBest,\nRok` });

    // Day 19 WhatsApp voice note
    m.push({ day:19, channel:'whatsapp', phase:'conversion', purpose:'Personal Voice Note',
      subject: null,
      body: `VOICE NOTE SCRIPT (30 to 45 seconds):\n\n"${greeting}, it is Rok. I just wanted to follow up on the guest portal I built for ${hn}. I know you are busy, so I will keep this short. I would love just 15 minutes of your time to show you the full potential of what this can do for your guests and your team. Would any time this week or next work for a quick video call? Let me know, and I will send over a calendar link. Thanks!"`,
      note: 'Record as a WhatsApp voice note, not text. Voice notes feel personal and get high engagement.' });

    // Day 21 Email
    m.push({ day:21, channel:'email', phase:'conversion', purpose:'Breakup: "Should I Close the Portal?"',
      subject: `Should I close ${hn}'s portal?`,
      body: `${greeting},\n\nI built a guest portal for ${hn} a few weeks ago and shared it with you, but I have not heard back.\n\nTotally understand if the timing is not right. The portal will stay live for now, so you can explore it whenever it makes sense: ${url}\n\nIf this is something ${hn} might consider in the future, just let me know and I will keep you updated with what other hotels are doing with theirs.\n\nBest,\nRok`,
      note: 'The "Should I close this?" framing triggers loss aversion. Most effective breakup email format.' });

    return m;
  }

  // ============================================================
  // GENERAL OUTREACH MESSAGES (SL)
  // ============================================================
  function genGeneralSL(d) {
    const m = [];
    const hn = d.hotelName, url = d.portalUrl, city = d.city;
    const fn = d.contactName || '';
    const greeting = fn ? `Pozdravljeni ${fn}` : 'Pozdravljeni';

    // Dan 1 Email
    m.push({ day:1, channel:'email', phase:'reveal', purpose:'Predstavitev portala',
      subject: `Portal za goste hotela ${hn}`,
      body: `${greeting},\n\nopazil sem, da ${hn} nima digitalnega portala za goste, zato sem ga pripravil: ${url}\n\nŽe vključuje informacije o hotelu, podrobnosti o sobah in priporočila za okolico${city ? ' (' + city + ')' : ''}. Gostje si ga na telefon naložijo z enim klikom.\n\nBrez kakršnihkoli obveznosti, preprosto si ga oglejte.\n\nČe bi želeli videti različico z Vašo celostno grafično podobo in povezavo z rezervacijskim sistemom, Vam jo z veseljem predstavim. Za zdaj si portal le oglejte.\n\nLep pozdrav,\nRok` });

    // Dan 2 LinkedIn
    m.push({ day:2, channel:'linkedin', phase:'reveal', purpose:'Zahteva za povezavo',
      subject: null,
      body: `${greeting}, ukvarjam se z digitalnimi izkušnjami gostov v hotelirstvu. Po e-pošti sem Vam poslal nekaj, kar bi ${hn} utegnilo zanimati. Bi se povezali?`,
      note: 'Send as connection request note (max 300 chars). If already connected, send as DM instead.' });

    // Dan 3 WhatsApp
    m.push({ day:3, channel:'whatsapp', phase:'reveal', purpose:'Prvo sporočilo s povezavo',
      subject: null,
      body: `${greeting}, tukaj Rok iz Nevrona.\n\nPripravil sem digitalni portal za goste posebej za ${hn}: ${url}\n\nDeluje kot aplikacija, ki si jo gostje naložijo na telefon. Že vsebuje podatke o hotelu, vodič po okolici in priporočila.\n\nMe zanima Vaše mnenje.\n\n(Odgovorite STOP za odjavo)` });

    // Dan 5 Email
    m.push({ day:5, channel:'email', phase:'reveal', purpose:'Predstavitev z video vodičem',
      subject: `90 sekund: portal za goste hotela ${hn}`,
      body: `${greeting},\n\npred nekaj dnevi sem Vam poslal portal za goste hotela ${hn}. Če si ga še niste uspeli ogledati, sem posnel kratek 90-sekundni vodič: [VIDEO LINK]\n\nPrikazuje, kako bi gostje portal uporabljali za iskanje restavracij, rezervacijo aktivnosti${city ? ' in raziskovanje okolice ' + city : ' in raziskovanje okolice'}.\n\nZ veseljem odgovorim na morebitna vprašanja.\n\nLep pozdrav,\nRok` });

    // Dan 7 Phone
    m.push({ day:7, channel:'phone', phase:'value', purpose:'Klic za nadaljevanje',
      subject: null,
      body: `UVOD:\n"${greeting}, tukaj Rok iz Nevrona. Pred kratkim sem Vam poslal portal za goste hotela ${hn}. Želel sem preveriti, ali ste imeli priložnost, da si ga ogledate."\n\nČE SO GA VIDELI:\n"Odlično! Kaj menite? [Poslušajte] Ta različica je pripravljena na podlagi javno dostopnih podatkov. Predstavljajte si, kako bi izgledal z Vašo celostno grafično podobo, povezavo z rezervacijskim sistemom in prilagojenimi priporočili. Bi se splačalo, da si vzamemo 15 minut za predstavitev polne različice?"\n\nČE GA NISO VIDELI:\n"Ni problema. Na kratko: pripravil sem digitalni portal za goste posebej za ${hn}. Gostje si ga namestijo na telefon in z njim najdejo vse o Vašem hotelu${city ? ' in okolici ' + city : ''}. Naj Vam ga ponovno pošljem? Bi imeli ta teden 15 minut za kratek ogled?"\n\nČE ODKLONIJO:\n"Popolnoma razumem. Portal je na voljo kadarkoli na ${url}. Če si ga boste ogledali in bi se želeli pogovoriti, sem vedno dosegljiv."`,
      note: 'Best call times: Tue to Thu, 10:00 to 11:30 or 14:00 to 15:30. Avoid check-in rush hours.' });

    // Dan 8 Email
    m.push({ day:8, channel:'email', phase:'value', purpose:'Primeri in reference',
      subject: 'Kako hoteli z digitalnim portalom povečujejo prihodke',
      body: `${greeting},\n\nhoteli z Nevronovim portalom za goste tipično dosegajo:\n\n- +13 % rast prihodkov (skozi vse implementacije)\n- Zmanjšanje povpraševanj na recepciji (do 30 %)\n- Marketinška ekipa aktivno upravlja vsebine prek platforme\n\nNekaj primerov:\n- Carana Beach Resort (Sejšeli, 40 sob): neprekinjene nadgradnje od leta 2016, +13 % prihodkov\n- The Fives Oceanfront (Mehika, 84 sob): +13 % prihodkov, digitalno obvestilno oglaševanje\n- Edgewater Resort & Spa (Cookovi otoki, 280 sob): +13 % prihodkov, zmanjšanje povpraševanj na recepciji\n\nPortal za ${hn} je že pripravljen: ${url}\n\nBi se splačalo nameniti 15 minut za pogovor o možnostih?\n\nLep pozdrav,\nRok` });

    // Dan 10 WhatsApp
    m.push({ day:10, channel:'whatsapp', phase:'value', purpose:'Predstavitev funkcionalnosti',
      subject: null,
      body: `${greeting}, kratka novost o portalu hotela ${hn}.\n\nAli ste vedeli, da Vaši gostje lahko prek portala uporabijo interaktivni vodič po okolici, prilagojena priporočila in orodja za komunikacijo z Vašo ekipo?\n\nPodobna funkcionalnost je pri hotelih z enakim portalom zmanjšala vprašanja na recepciji za 30 %.\n\nZ veseljem Vam pokažem več.` });

    // Dan 12 LinkedIn
    m.push({ day:12, channel:'linkedin', phase:'value', purpose:'Deljenje vsebine',
      subject: null,
      body: `${greeting}, naletel sem na zanimiv vpogled o trendih digitalne izkušnje gostov v hotelirstvu in pomislil na ${hn}.\n\n[Deli relevanten članek ali vpogled]\n\nMe zanima, ali to sovpada z Vašimi izkušnjami. Portal, ki sem ga pripravil za ${hn}, naslavlja več teh trendov.`,
      note: 'Find a relevant hotel tech article. Engage with their LinkedIn activity before sending.' });

    // Dan 14 Email
    m.push({ day:14, channel:'email', phase:'value', purpose:'ROI in prošnja za sestanek',
      subject: `Številke za portalom hotela ${hn}`,
      body: `${greeting},\n\nhoteli z digitalnim portalom za goste tipično dosežejo:\n\n- Izboljšanje ocene, ki vodi k višjemu ADR\n- 2 do 5 % povečanje prihodkov od dodatnih storitev (spa, restavracija, aktivnosti)\n- 20 do 30 % zmanjšanje ponavljajočih se vprašanj na recepciji\n\nIndustrijski standard: izboljšanje ocene za 0,1 točke pomeni 10 EUR več na sobo na noč.\n\nZ veseljem bi izračunal, kaj to konkretno pomeni za ${hn}. Za natančen izračun bi potreboval le 15 minut Vašega časa.\n\nBi Vam kateri dan naslednji teden ustrezal?\n\nLep pozdrav,\nRok` });

    // Dan 16 Phone
    m.push({ day:16, channel:'phone', phase:'conversion', purpose:'Drugi klic',
      subject: null,
      body: `UVOD:\n"${greeting}, tukaj Rok iz Nevrona. Zadnji dve tedna sem z Vami delil portal za goste hotela ${hn}. Ste imeli priložnost, da si ga ogledate?"\n\nKLJUČNE TOČKE:\n- Omenite specifične funkcionalnosti portala\n- Navedite primer: "Carana Beach Resort dosega +13 % prihodkov"\n- Prosite za 15-minutni video klic\n- Če čas ne ustreza, vprašajte kdaj bi bilo bolje\n\nGLASOVNA POŠTA:\n"${greeting}, tukaj Rok iz Nevrona. Sledim portalu za goste, ki sem ga pripravil za ${hn}. Imam nekaj zanimivih podatkov o tem, kako podobni hoteli uporabljajo svoj portal. Z veseljem bi Vam namenil 15 minut. Poslal Vam bom e-pošto z razpoložljivimi termini."`,
      note: 'Attempt #2 if Day 7 call was missed.' });

    // Dan 17 Email
    m.push({ day:17, channel:'email', phase:'conversion', purpose:'Ponudba za nadgradnjo',
      subject: `Nadgradnja portala hotela ${hn}`,
      body: `${greeting},\n\nportal za goste hotela ${hn} trenutno temelji na javno dostopnih podatkih. Takole bi lahko izgledal v polni postavitvi:\n\nTrenutna različica:\n- Informacije o hotelu in sobah\n- Interaktivni vodič po okolici${city ? ' (' + city + ')' : ''}\n- Lokalna priporočila\n\nPolna različica (z Vašim sodelovanjem):\n- Vaša celostna grafična podoba\n- Povezava z rezervacijskim sistemom\n- Prilagojena komunikacija z gosti\n- Moduli za dodatno prodajo (spa, restavracija, aktivnosti)\n- Nadzorna plošča za osebje in upravljanje vsebin\n\nZ veseljem bi dodal Vašo grafično podobo in naredil portal resnično Vašega. Bi imeli 15 minut?\n\nLep pozdrav,\nRok` });

    // Dan 19 WhatsApp glasovno sporočilo
    m.push({ day:19, channel:'whatsapp', phase:'conversion', purpose:'Osebno glasovno sporočilo',
      subject: null,
      body: `SKRIPT ZA GLASOVNO SPOROČILO (30 do 45 sekund):\n\n"${greeting}, tukaj Rok. Želel sem se navezati na portal za goste, ki sem ga pripravil za ${hn}. Vem, da ste zaposleni, zato bom kratek. Z veseljem bi si vzel 15 minut in Vam pokazal celoten potencial portala za Vaše goste in Vašo ekipo. Bi imeli čas ta ali naslednji teden za kratek video klic? Sporočite mi in pošljem Vam povezavo za termin. Hvala!"`,
      note: 'Record as a WhatsApp voice note, not text. Voice notes feel personal and get very high engagement.' });

    // Dan 21 Email
    m.push({ day:21, channel:'email', phase:'conversion', purpose:'Zaključno sporočilo',
      subject: `Naj zaključim portal hotela ${hn}?`,
      body: `${greeting},\n\npred nekaj tedni sem pripravil portal za goste hotela ${hn} in ga delil z Vami, vendar se nisva uspela povezati.\n\nPopolnoma razumem, če čas ni pravi. Portal za zdaj ostaja aktiven, tako da si ga lahko ogledate, kadarkoli bo primerno: ${url}\n\nČe je to nekaj, kar bi ${hn} utegnil upoštevati v prihodnosti, mi le sporočite in Vas bom obveščal o tem, kaj drugi hoteli počnejo s svojimi portali.\n\nLep pozdrav,\nRok`,
      note: 'The "Should I close the portal?" framing triggers loss aversion. Most effective breakup email format.' });

    return m;
  }

  // ============================================================
  // GENERAL: FORM DATA, VALIDATE, GENERATE
  // ============================================================
  function getGeneralFormData() {
    const langR = document.querySelector('input[name="gen-lang"]:checked');
    return {
      hotelName: document.getElementById('gen-hotelName').value.trim(),
      city: document.getElementById('gen-city').value.trim(),
      portalUrl: document.getElementById('gen-portalUrl').value.trim(),
      contactName: document.getElementById('gen-contactName').value.trim(),
      lang: langR ? langR.value : 'sl'
    };
  }

  function validateGeneral(d) {
    let ok = true;
    ['hotelName','portalUrl'].forEach(f => {
      const el = document.getElementById('gen-' + f), err = document.getElementById('err-gen-' + f);
      if (!d[f]) { el.classList.add('error'); if (err) err.classList.add('show'); ok = false; }
      else { el.classList.remove('error'); if (err) err.classList.remove('show'); }
    });
    return ok;
  }

  function generateGeneral(d) {
    var hn = d.hotelName || '[Hotel Name]';
    var url = d.portalUrl || '[Portal URL]';
    var gd = { hotelName: hn, portalUrl: url, city: d.city, contactName: d.contactName, lang: d.lang };
    var messages = d.lang === 'sl' ? genGeneralSL(gd) : genGeneralEN(gd);
    currentMessages = messages;
    isGeneralMode = true;

    document.getElementById('output-hero').style.display = 'none';

    document.getElementById('summary-content').innerHTML = '<div class="summary-grid">'
      + '<div class="summary-card"><div class="summary-label">Hotel</div><div class="summary-value">' + esc(hn) + (d.city ? '<br><small>' + esc(d.city) + '</small>' : '') + '</div></div>'
      + '<div class="summary-card"><div class="summary-label">Portal</div><div class="summary-value">' + (d.portalUrl ? '<a href="' + esc(url) + '" target="_blank" style="color:var(--accent-light);word-break:break-all;">' + esc(url) + '</a>' : '<span style="color:var(--text-muted);">[Portal URL]</span>') + '</div></div>'
      + '<div class="summary-card"><div class="summary-label">Sequence</div><div class="summary-value">' + messages.length + ' touchpoints / 21 days<div class="channel-badges"><span class="channel-badge email">Email</span><span class="channel-badge linkedin">LinkedIn</span><span class="channel-badge whatsapp">WhatsApp</span><span class="channel-badge phone">Phone</span></div></div></div>'
      + '</div>';

    document.getElementById('timeline-content').innerHTML = renderTimeline(messages);
    document.getElementById('messages-content').innerHTML = renderMessages(messages);
    document.getElementById('checklist-content').innerHTML = renderChecklist(messages, hn);
    document.getElementById('gen-date').textContent = new Date().toLocaleDateString('en-GB', { day:'numeric', month:'long', year:'numeric' });

    // Render generic loom script
    var isSL = d.lang === 'sl';
    var fn = d.contactName || '';
    var loomGreeting = isSL
      ? (fn ? 'Pozdravljeni ' + fn : 'Pozdravljeni')
      : (fn ? 'Hi ' + fn : 'Hi there');
    var loomSteps = isSL ? [
      { t: 'Uvod (10 sek)', d: '"' + loomGreeting + ', tukaj Rok iz Nevrona. Pripravil sem digitalni portal za goste hotela ' + hn + ' in Vam želim na hitro pokazati, kaj zmore."' },
      { t: 'Prikaz portala (30 sek)', d: 'Odprite ' + url + '. Pokažite začetni zaslon, informacije o sobah in vodič po okolici' + (d.city ? ' (' + d.city + ')' : '') + ' z restavracijami, znamenitostmi in aktivnostmi. Poudarite, kako izgleda na mobilnem telefonu.' },
      { t: 'Ključna funkcionalnost (20 sek)', d: 'Osredotočite se na interaktivni vodič po okolici, orodja za komunikacijo z gosti in prilagojena priporočila. Pojasnite, kako to dvigne izkušnjo gostov in razbremeni recepcijo.' },
      { t: 'Referenca (15 sek)', d: '"Hoteli, ki uporabljajo Nevronov portal, dosegajo +13 % rast prihodkov in do 30 % manj povpraševanj na recepciji. Carana Beach Resort na Sejšelih portal uporablja neprekinjeno od leta 2016."' },
      { t: 'Poziv k akciji (15 sek)', d: '"To je začetna različica. S 15 minutami Vašega časa lahko dodam Vašo celostno grafično podobo, integracijo z rezervacijskim sistemom in prilagojene funkcionalnosti. Bi se splačalo za kratek klic? Preprosto odgovorite na mojo e-pošto."' }
    ] : [
      { t: 'Introduction (10 sec)', d: '"' + loomGreeting + ', this is Rok from Nevron. I built a digital guest portal for ' + hn + ' and I want to give you a quick tour of what it can do."' },
      { t: 'Show the Portal (30 sec)', d: 'Open ' + url + '. Walk through the home screen, room information, and the ' + (d.city || 'local') + ' area guide. Point out how it looks on a mobile phone.' },
      { t: 'Key Feature (20 sec)', d: 'Focus on the interactive area guide, guest communication tools, and personalized recommendations. Explain how this elevates the guest experience and reduces front desk inquiries.' },
      { t: 'Social Proof (15 sec)', d: '"Hotels using Nevron portals see +13% revenue increase and up to 30% fewer front desk inquiries. Carana Beach Resort in the Seychelles has been using their portal continuously since 2016."' },
      { t: 'Call to Action (15 sec)', d: '"This is the starter version. With 15 minutes of your time, I can add your full branding, live booking integration, and custom features. Would that be worth a quick call? Just reply to my email."' }
    ];
    document.getElementById('loom-content').innerHTML = '<div class="loom-script">' + loomSteps.map(function(s,i) { return '<div class="loom-step"><div class="loom-step-num">' + (i+1) + '</div><div class="loom-step-content"><div class="loom-step-title">' + s.t + '</div><div class="loom-step-desc">' + s.d + '</div></div></div>'; }).join('') + '</div>'
      + '<div class="callout warn" style="margin-top:16px;"><div class="callout-title">Recording Tips</div><div class="callout-text">Keep it under 90 seconds. Use screen recording with your face in the corner (Loom, Tella, or similar). Smile, be natural. Personalized video drives 5x higher click through rates and 3x response rates.</div></div>';

    document.getElementById('summary-section').style.display = '';
    document.getElementById('timeline-section').style.display = '';
    document.getElementById('messages-section').style.display = '';
    document.getElementById('checklist-section').style.display = '';
    document.getElementById('loom-section').style.display = '';
    document.getElementById('roi-section').style.display = 'none';

    outputView.style.display = '';
  }

  // ============================================================
  // FORM SUBMIT
  // ============================================================
  generalForm.addEventListener('submit', function(e) {
    e.preventDefault();
    generateGeneral(getGeneralFormData());
    document.getElementById('summary-section').scrollIntoView({ behavior: 'smooth' });
  });

  form.addEventListener('submit', function(e) {
    e.preventDefault();
    const d = getFormData();
    if (!validate(d)) { showToast('Please fill in all required fields'); return; }
    generate(d);
  });

  // ============================================================
  // INIT
  // ============================================================
  const urlData = loadFromUrlParams();
  if (urlData) setFormData(urlData);
  else { const saved = loadFormData(); if (saved) setFormData(saved); }

})();
</script>
</body>
</html>
